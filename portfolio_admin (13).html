<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Portfolio Admin</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#F8FAFC;--card:#fff;--border:#E2E8F0;--text:#0F172A;--sub:#64748B;--sub2:#94A3B8;--blue:#3B82F6;--green:#10B981;--font:'Inter',system-ui,sans-serif;--r:14px}
body{font-family:var(--font);background:var(--bg);color:var(--text);min-height:100vh}
#topbar{background:rgba(255,255,255,.9);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:14px 24px 10px;position:sticky;top:0;z-index:100}
.tb-row1{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.tb-title{font-size:1rem;font-weight:800}.tb-sub{font-size:.71rem;color:var(--sub);margin-top:1px}
.badge{background:#FEF9C3;border:1px solid #FDE047;color:#854D0E;font-size:.65rem;font-weight:700;padding:3px 10px;border-radius:99px;letter-spacing:.06em;white-space:nowrap}
.tb-name-row{display:flex;align-items:center;gap:6px}
.tb-name-lbl{font-size:.65rem;text-transform:uppercase;letter-spacing:.08em;font-weight:700;color:var(--sub2);white-space:nowrap}
#adminName{flex:0 1 200px;max-width:200px;background:#F8FAFC;border:1px solid var(--border);border-radius:8px;padding:6px 10px;font-size:.82rem;font-family:var(--font);color:var(--text);outline:none}
#adminName:focus{border-color:#94A3B8;box-shadow:0 0 0 3px rgba(148,163,184,.15)}
#adminName::placeholder{color:var(--sub2)}
#main{max-width:560px;margin:0 auto;padding:24px 16px}
.steps{display:flex;align-items:center;margin-bottom:24px}
.step{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1;position:relative}
.step:not(:last-child)::after{content:'';position:absolute;top:14px;left:55%;width:90%;height:2px;background:var(--border)}
.step-num{width:28px;height:28px;border-radius:50%;background:var(--border);color:var(--sub);font-weight:800;font-size:.78rem;display:flex;align-items:center;justify-content:center;position:relative;z-index:1;transition:.25s}
.step-lbl{font-size:.6rem;color:var(--sub2);font-weight:600;text-transform:uppercase;letter-spacing:.05em;text-align:center}
.step.active .step-num{background:var(--blue);color:#fff}.step.done .step-num{background:var(--green);color:#fff}
.card{background:var(--card);border-radius:var(--r);border:1px solid var(--border);box-shadow:0 1px 4px rgba(0,0,0,.05);margin-bottom:16px;overflow:hidden}
.card-hdr{padding:12px 16px;border-bottom:1px solid #F1F5F9;display:flex;align-items:center;gap:8px}
.card-hdr-dot{width:8px;height:8px;border-radius:50%}.card-hdr-title{font-size:.82rem;font-weight:700}
.card-body{padding:16px}
label.drop-zone{display:block;border:2px dashed #CBD5E1;border-radius:10px;padding:36px 20px;text-align:center;cursor:pointer;background:#F8FAFC;transition:border-color .2s,background .2s}
label.drop-zone:hover,label.drop-zone.drag{border-color:var(--blue);background:#EFF6FF}
label.drop-zone.loaded{border-color:var(--green);background:#F0FDF4}
label.drop-zone *{pointer-events:none}
label.drop-zone input[type=file]{display:none}
.dz-icon{font-size:2rem;line-height:1;margin-bottom:8px}.dz-main{font-size:.88rem;font-weight:700;margin-bottom:3px}.dz-sub{font-size:.74rem;color:var(--sub2)}.dz-fname{font-size:.78rem;font-weight:700;color:var(--green);margin-top:8px;min-height:1.2em}
.fmt-box{background:#F8FAFC;border:1px solid var(--border);border-radius:8px;padding:12px 14px;margin-top:14px;font-size:.73rem;color:var(--sub)}
.fmt-box strong{color:var(--text);display:block;margin-bottom:8px;font-size:.78rem}
.fmt-box table{width:100%;border-collapse:collapse}
.fmt-box th{background:#F1F5F9;padding:4px 8px;text-align:left;font-size:.68rem;color:var(--sub);font-weight:600}
.fmt-box td{padding:4px 8px;border-bottom:1px solid #F1F5F9;font-size:.69rem;font-family:monospace}
.fmt-box code{background:#E2E8F0;border-radius:3px;padding:1px 4px;font-family:monospace;color:#1D4ED8}
.prev-meta{font-size:.75rem;color:var(--sub);margin-bottom:12px;display:flex;gap:14px;flex-wrap:wrap}
.prev-meta span{font-weight:700;color:var(--blue)}
.prev-parent{margin-bottom:8px;border-radius:8px;overflow:hidden;border:1px solid var(--border)}
.prev-phdr{background:linear-gradient(90deg,#1E3A5F,#2563EB);color:#fff;padding:7px 12px;font-size:.8rem;font-weight:700;display:flex;justify-content:space-between}
.prev-srow{padding:6px 12px 6px 18px;border-bottom:1px solid #F8FAFC;display:flex;justify-content:space-between;font-size:.73rem}
.prev-srow:last-child{border-bottom:none}.prev-sname{font-weight:600}.prev-fcount{color:var(--sub2);font-style:italic}
.prev-tag{font-size:.62rem;padding:1px 6px;border-radius:99px;font-weight:700;margin-left:5px}
.tag-custom{background:#FEF9C3;color:#854D0E}.tag-nofunds{background:#FEE2E2;color:#991B1B}
.btn-row{display:flex;gap:8px;justify-content:flex-end;margin-top:14px;flex-wrap:wrap}
.btn{padding:9px 20px;border-radius:9px;font-size:.82rem;font-weight:700;cursor:pointer;border:none;font-family:var(--font);transition:opacity .2s,transform .15s}
.btn:disabled{opacity:.32;cursor:not-allowed}.btn:not(:disabled):hover{opacity:.85;transform:translateY(-1px)}
#btnPreview{background:var(--blue);color:#fff}#btnGenerate{background:var(--green);color:#fff}#btnAdminReset{background:#F1F5F9;color:var(--sub)}
.msg{padding:10px 14px;border-radius:8px;font-size:.77rem;margin-top:12px;display:none;line-height:1.6}
.msg.show{display:block}.msg.err{background:#FEF2F2;color:#991B1B;border:1px solid #FECACA}.msg.ok{background:#F0FDF4;color:#166534;border:1px solid #BBF7D0}
#placeholder{color:var(--sub2);font-size:.78rem;font-style:italic}
.workflow ol{padding-left:16px;line-height:2.2;font-size:.76rem;color:var(--sub)}
.workflow li strong{color:var(--text)}.workflow code{background:#E2E8F0;border-radius:3px;padding:1px 5px;font-family:monospace;font-size:.72rem;color:#1D4ED8}
#fab{position:fixed;bottom:20px;right:20px;width:48px;height:48px;border-radius:50%;background:#fff;border:1px solid var(--border);box-shadow:0 4px 12px rgba(0,0,0,.1);display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:290;font-size:1.2rem;color:var(--text);transition:transform .2s,box-shadow .2s}
#fab:hover{transform:scale(1.08);box-shadow:0 6px 18px rgba(0,0,0,.14)}
#fab:active{transform:scale(.94)}
#fab-tip{position:fixed;bottom:30px;right:72px;background:#1E293B;color:#fff;font-size:.68rem;font-weight:600;font-family:var(--font);padding:5px 10px;border-radius:7px;white-space:nowrap;pointer-events:none;opacity:0;transform:translateX(4px);transition:opacity .18s,transform .18s;z-index:291}
#fab-tip::after{content:'';position:absolute;top:50%;right:-5px;transform:translateY(-50%);border:5px solid transparent;border-left-color:#1E293B;border-right:none}
#fab:hover + #fab-tip{opacity:1;transform:translateX(0)}
</style>
</head>
<body>
<div id="topbar"><div class="tb-row1"><div><div class="tb-title">&#x2699;&#xFE0F; Portfolio Admin</div><div class="tb-sub">Fund Data Manager</div></div><span class="badge">ADMIN ONLY</span></div><div class="tb-name-row"><label class="tb-name-lbl" for="adminName">Session</label><input id="adminName" type="text" placeholder="e.g. Q1 2026 update" autocomplete="off"/></div></div>
<div id="main">
<div class="steps"><div class="step active" id="step1"><div class="step-num">1</div><div class="step-lbl">Upload CSV</div></div><div class="step" id="step2"><div class="step-num">2</div><div class="step-lbl">Preview</div></div><div class="step" id="step3"><div class="step-num">3</div><div class="step-lbl">Download</div></div></div>
<div class="card"><div class="card-hdr"><div class="card-hdr-dot" style="background:#3B82F6"></div><span class="card-hdr-title">&#x2460; Upload Fund Data CSV</span></div><div class="card-body"><label id="dropZone" class="drop-zone" for="fileInput"><div class="dz-icon">&#x1F4C2;</div><div class="dz-main">Drop your CSV here &mdash; or click to browse</div><div class="dz-sub">Only .csv files &bull; Fully local</div><div class="dz-fname" id="dzFname"></div><input type="file" id="fileInput" accept=".csv"/></label>
<div class="msg err" id="msgErr"></div>
<div class="fmt-box"><strong>Required CSV columns</strong><table><tr><th>Column</th><th>Example</th><th>Notes</th></tr><tr><td>parent_id</td><td>equity</td><td>Unique lowercase key</td></tr><tr><td>parent_name</td><td>Equity</td><td>Display label</td></tr><tr><td>sub_id</td><td>flexicap</td><td>Unique lowercase key</td></tr><tr><td>sub_name</td><td>Flexi Cap</td><td>Display label</td></tr><tr><td>fund_type</td><td>recommended</td><td><code>recommended</code>, <code>all</code>, or <code>custom</code></td></tr><tr><td>fund_name</td><td>Parag Parikh Flexi Cap</td><td>Leave blank for custom rows</td></tr></table></div>
<div class="btn-row"><button class="btn" id="btnAdminReset">&#x21BA; Reset</button><button class="btn" id="btnPreview" disabled>Preview &rarr;</button></div></div></div>
<div class="card" id="previewCard"><div class="card-hdr"><div class="card-hdr-dot" style="background:#10B981"></div><span class="card-hdr-title">&#x2461; Preview Parsed Structure</span></div><div class="card-body"><p id="placeholder">Upload a CSV above to see the parsed structure here.</p><div id="preview" style="display:none"><div class="prev-meta" id="prevMeta"></div><div id="prevContent"></div><div class="btn-row"><button class="btn" id="btnGenerate" disabled>&#x2B07; Generate &amp; Download portfolio_tool.html</button></div></div></div></div>
<div class="msg ok" id="msgDone"></div>
<div class="card workflow"><div class="card-hdr"><div class="card-hdr-dot" style="background:#A855F7"></div><span class="card-hdr-title">&#x1F4CB; How It Works</span></div><div class="card-body"><ol><li>Edit <code>portfolio_funds.csv</code> in Excel or Google Sheets</li><li>Drop it here &rarr; click <strong>Preview</strong> to verify</li><li>Click <strong>Generate &amp; Download</strong></li><li>Upload <code>portfolio_tool.html</code> to your site</li><li><em>This admin file stays private</em></li></ol></div></div>
</div>
<button id="fab">&#x2191;</button><div id="fab-tip">Back to top</div>
<script>
var TOOL_TEMPLATE_B64="PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj48aGVhZD4KPG1ldGEgY2hhcnNldD0iVVRGLTgiLz4KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEuMCx2aWV3cG9ydC1maXQ9Y292ZXIiLz4KPHRpdGxlPlBvcnRmb2xpbyBDb25zdHJ1Y3RvcjwvdGl0bGU+CjxzdHlsZT4KQGltcG9ydCB1cmwoJ2h0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzMj9mYW1pbHk9SW50ZXI6d2dodEAzMDA7NDAwOzUwMDs2MDA7NzAwOzgwMDs5MDAmZGlzcGxheT1zd2FwJyk7CiosKjo6YmVmb3JlLCo6OmFmdGVye2JveC1zaXppbmc6Ym9yZGVyLWJveDttYXJnaW46MDtwYWRkaW5nOjB9Cjpyb290ey0tYmc6I0Y4RkFGQzstLWNhcmQ6I0ZGRkZGRjstLWJvcmRlcjojRTJFOEYwOy0tdGV4dDojMEYxNzJBOy0tc3ViOiM2NDc0OEI7LS1zdWIyOiM5NEEzQjg7LS1ncmVlbjojMTBCOTgxOy0tcmVkOiNFRjQ0NDQ7LS1mb250OidJbnRlcicsc3lzdGVtLXVpLHNhbnMtc2VyaWY7LS1yOjE2cHh9Cmh0bWx7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fQpib2R5e2ZvbnQtZmFtaWx5OnZhcigtLWZvbnQpO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOnZhcigtLXRleHQpO21pbi1oZWlnaHQ6MTAwdmg7Zm9udC1zaXplOjE1cHh9CmlucHV0W3R5cGU9bnVtYmVyXXstbW96LWFwcGVhcmFuY2U6dGV4dGZpZWxkfQppbnB1dFt0eXBlPW51bWJlcl06Oi13ZWJraXQtaW5uZXItc3Bpbi1idXR0b24saW5wdXRbdHlwZT1udW1iZXJdOjotd2Via2l0LW91dGVyLXNwaW4tYnV0dG9uey13ZWJraXQtYXBwZWFyYW5jZTpub25lO21hcmdpbjowfQojdG9wYmFye2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuODUpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDE2cHgpOy13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOmJsdXIoMTZweCk7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tYm9yZGVyKTtwYWRkaW5nOjE0cHggMjBweCAxMHB4O3Bvc2l0aW9uOnN0aWNreTt0b3A6MDt6LWluZGV4OjIwMH0KLnRiLXJvdzF7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjttYXJnaW4tYm90dG9tOjhweH0KLnRiLXRpdGxle2ZvbnQtc2l6ZToxLjJyZW07Zm9udC13ZWlnaHQ6ODAwO2xldHRlci1zcGFjaW5nOi0uMDJlbTtsaW5lLWhlaWdodDoxLjJ9Ci50Yi1zdWJ7Zm9udC1zaXplOi43MnJlbTtjb2xvcjp2YXIoLS1zdWIpO21hcmdpbi10b3A6MXB4fQoudGItbmFtZS1yb3d7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6NnB4fQoudGItbmFtZS1sYmx7Zm9udC1zaXplOi42NXJlbTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA4ZW07Zm9udC13ZWlnaHQ6NzAwO2NvbG9yOnZhcigtLXN1YjIpO3doaXRlLXNwYWNlOm5vd3JhcH0KI3BuYW1le2ZsZXg6MCAxIDE4MHB4O21heC13aWR0aDoxODBweDtiYWNrZ3JvdW5kOiNGOEZBRkM7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6OHB4O3BhZGRpbmc6NnB4IDEwcHg7Zm9udC1zaXplOi44MnJlbTtmb250LWZhbWlseTp2YXIoLS1mb250KTtjb2xvcjp2YXIoLS10ZXh0KTtvdXRsaW5lOm5vbmU7dHJhbnNpdGlvbjpib3gtc2hhZG93IC4ycyxib3JkZXItY29sb3IgLjJzfQojcG5hbWU6Zm9jdXN7Ym9yZGVyLWNvbG9yOiM5NEEzQjg7Ym94LXNoYWRvdzowIDAgMCAzcHggcmdiYSgxNDgsMTYzLDE4NCwuMTUpfQojcG5hbWU6OnBsYWNlaG9sZGVye2NvbG9yOnZhcigtLXN1YjIpfQojYnRuUmVzZXR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6NXB4O2ZsZXgtc2hyaW5rOjA7YmFja2dyb3VuZDojRkZGMUYyO2JvcmRlcjoxcHggc29saWQgI0ZFQ0REMztjb2xvcjojRTExRDQ4O2JvcmRlci1yYWRpdXM6OHB4O3BhZGRpbmc6NnB4IDEycHg7Zm9udC1zaXplOi43NXJlbTtmb250LXdlaWdodDo3MDA7Y3Vyc29yOnBvaW50ZXI7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC4xOHMsdHJhbnNmb3JtIC4xNXM7d2hpdGUtc3BhY2U6bm93cmFwfQojYnRuUmVzZXQ6aG92ZXJ7YmFja2dyb3VuZDojRkZFNEU2O3RyYW5zZm9ybTpzY2FsZSgxLjAzKX0KI2J0blJlc2V0OmFjdGl2ZXt0cmFuc2Zvcm06c2NhbGUoLjk2KX0KI3Byb2ctd3JhcHtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsLjg1KTtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxNnB4KTstd2Via2l0LWJhY2tkcm9wLWZpbHRlcjpibHVyKDE2cHgpO3BhZGRpbmc6MDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO3Bvc2l0aW9uOnN0aWNreTt0b3A6OTZweDt6LWluZGV4OjE5MH0KI3Byb2ctaW5uZXJ7cGFkZGluZzowIDIwcHggMTBweH0KLnByb2ctcm93e2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpmbGV4LWVuZDtwYWRkaW5nOjhweCAwIDZweH0KLnByb2ctbGJsLXR4dHtmb250LXNpemU6LjY1cmVtO2ZvbnQtd2VpZ2h0OjcwMDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6LjA4ZW07Y29sb3I6dmFyKC0tc3ViMil9CiNwcm9nUGN0e2ZvbnQtc2l6ZToxLjM1cmVtO2ZvbnQtd2VpZ2h0OjkwMDtsZXR0ZXItc3BhY2luZzotLjAzZW07Y29sb3I6dmFyKC0tZ3JlZW4pO3RyYW5zaXRpb246Y29sb3IgLjNzO2xpbmUtaGVpZ2h0OjF9CiNwcm9nUGN0LmMtb3Zlcntjb2xvcjp2YXIoLS1yZWQpfQoucHJvZy10cmFja3tiYWNrZ3JvdW5kOiNFMkU4RjA7Ym9yZGVyLXJhZGl1czo5OXB4O2hlaWdodDo3cHg7b3ZlcmZsb3c6aGlkZGVufQojcHJvZ0JhcntoZWlnaHQ6MTAwJTtib3JkZXItcmFkaXVzOjk5cHg7YmFja2dyb3VuZDp2YXIoLS1ncmVlbik7d2lkdGg6MCU7dHJhbnNpdGlvbjp3aWR0aCAuNHMgY3ViaWMtYmV6aWVyKC40LDAsLjIsMSksYmFja2dyb3VuZCAuM3N9CiNwcm9nU3RhdHVze2ZvbnQtc2l6ZTouNzJyZW07Y29sb3I6dmFyKC0tc3ViKTttYXJnaW4tdG9wOjVweDttaW4taGVpZ2h0OjE0cHh9CiNtYWlue3BhZGRpbmc6MTRweCAxNHB4IDA7bWF4LXdpZHRoOjQ4MHB4O21hcmdpbjowIGF1dG99Ci5wLWNhcmR7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtib3JkZXItcmFkaXVzOnZhcigtLXIpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTttYXJnaW4tYm90dG9tOjEycHg7b3ZlcmZsb3c6aGlkZGVuO2JveC1zaGFkb3c6MCAycHggOHB4IHJnYmEoMCwwLDAsLjA0KSwwIDFweCAycHggcmdiYSgwLDAsMCwuMDMpfQoucC1oZWFke2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzoxNnB4IDE2cHggMTRweDtjdXJzb3I6cG9pbnRlcjt1c2VyLXNlbGVjdDpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZX0KLnAtaGVhZC1sZWZ0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHh9Ci5wLWNvbG9yYmFye3dpZHRoOjdweDtoZWlnaHQ6MzJweDtib3JkZXItcmFkaXVzOjk5cHg7ZmxleC1zaHJpbms6MH0KLnAtbmFtZXtmb250LXNpemU6MXJlbTtmb250LXdlaWdodDo3MDA7bGV0dGVyLXNwYWNpbmc6LS4wMWVtO2xpbmUtaGVpZ2h0OjEuMn0KLnAtdGFsbHktZXJye2ZvbnQtc2l6ZTouNjdyZW07Y29sb3I6dmFyKC0tcmVkKTtmb250LXdlaWdodDo2MDA7bWFyZ2luLXRvcDoxcHg7ZGlzcGxheTpub25lO2xpbmUtaGVpZ2h0OjF9Ci5wLXRhbGx5LWVyci5zaG93e2Rpc3BsYXk6YmxvY2t9Ci5wLXBpbGx7Ym9yZGVyLXJhZGl1czo5OXB4O3BhZGRpbmc6NHB4IDEycHg7Zm9udC1zaXplOi44MnJlbTtmb250LXdlaWdodDo3MDA7d2hpdGUtc3BhY2U6bm93cmFwfQoucC1pbnAtcm93e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjNweH0KLnAtaW5we3dpZHRoOjUycHg7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtib3JkZXI6bm9uZTtmb250LXNpemU6MXJlbTtmb250LXdlaWdodDo3MDA7dGV4dC1hbGlnbjpyaWdodDtvdXRsaW5lOm5vbmU7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7Y29sb3I6aW5oZXJpdDtwYWRkaW5nOjA7Y3Vyc29yOnRleHR9Ci5wLXBjdC1zeW17Zm9udC1zaXplOi44OHJlbTtmb250LXdlaWdodDo2MDA7b3BhY2l0eTouN30KLnAtY2hldntmb250LXNpemU6LjdyZW07Y29sb3I6dmFyKC0tc3ViMik7bWFyZ2luLWxlZnQ6MnB4O3RyYW5zaXRpb246dHJhbnNmb3JtIC4yMnM7ZGlzcGxheTppbmxpbmUtYmxvY2s7bGluZS1oZWlnaHQ6MX0KLnAtY2hldi5vcGVue3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKX0KLnMtc2VjdGlvbntkaXNwbGF5Om5vbmU7Ym9yZGVyLXRvcDoxcHggc29saWQgI0YxRjVGOX0KLnMtc2VjdGlvbi5vcGVue2Rpc3BsYXk6YmxvY2t9Ci5zLWxpc3QtYXJlYXtwYWRkaW5nOjRweCAxNnB4IDE0cHh9Ci5zLWxpc3Qtcm93e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47cGFkZGluZzo3cHggMDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjRjhGQUZDfQoucy1saXN0LXJvdzpsYXN0LWNoaWxke2JvcmRlci1ib3R0b206bm9uZX0KLnMtbGlzdC1sZWZ0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7ZmxleDoxO21pbi13aWR0aDowfQoucy1saXN0LW5hbWV7Zm9udC1zaXplOi44MnJlbTtjb2xvcjp2YXIoLS1zdWIpO2ZvbnQtd2VpZ2h0OjUwMDt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7ZmxleDoxfQoucy1saXN0LXJpZ2h0e2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjNweDtmbGV4LXNocmluazowfQoucy1saXN0LWlucHt3aWR0aDo0NHB4O2JvcmRlcjpub25lO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Zm9udC1zaXplOi44MnJlbTtmb250LXdlaWdodDo2MDA7dGV4dC1hbGlnbjpyaWdodDtvdXRsaW5lOm5vbmU7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7Y29sb3I6dmFyKC0tdGV4dCk7cGFkZGluZzowfQoucy1saXN0LXBjdHtmb250LXNpemU6Ljc1cmVtO2NvbG9yOnZhcigtLXN1Yik7Zm9udC13ZWlnaHQ6NTAwfQoucy1leHBhbmQtYnRue2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7YmFja2dyb3VuZDpub25lO2JvcmRlcjpub25lO2N1cnNvcjpwb2ludGVyO3BhZGRpbmc6MDttYXJnaW4tbGVmdDo0cHh9Ci5zLWV4cGFuZC1kb3R7d2lkdGg6MTZweDtoZWlnaHQ6MTZweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOiNGMUY1Rjk7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfQoucy1leHBhbmQtZG90IHN2Z3t3aWR0aDo5cHg7aGVpZ2h0OjlweDtmaWxsOm5vbmU7c3Ryb2tlOiM5NEEzQjg7c3Ryb2tlLXdpZHRoOjEuNTt0cmFuc2l0aW9uOnRyYW5zZm9ybSAuMThzfQoucy1leHBhbmQtZG90Lm9wZW4gc3Zne3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKX0KLnMtaW5zdC1hcmVhe2JhY2tncm91bmQ6I0Y4RkFGQztib3JkZXItdG9wOjFweCBzb2xpZCAjRjFGNUY5O3BhZGRpbmc6OHB4IDE2cHggMTBweCAyMHB4O2Rpc3BsYXk6bm9uZTtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjVweH0KLnMtaW5zdC1hcmVhLm9wZW57ZGlzcGxheTpmbGV4fQoucy1pbnN0LXJvd3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHh9Ci5zLWluc3QtbGJse2ZvbnQtc2l6ZTouNjVyZW07Zm9udC13ZWlnaHQ6NzAwO2NvbG9yOnZhcigtLXN1YjIpO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzouMDZlbTttaW4td2lkdGg6NDRweH0KLnMtaW5zdC1zZWx7ZmxleDoxO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtiYWNrZ3JvdW5kOiNmZmY7Y29sb3I6dmFyKC0tdGV4dCk7Ym9yZGVyLXJhZGl1czo4cHg7cGFkZGluZzo1cHggOHB4O2ZvbnQtc2l6ZTouNzRyZW07b3V0bGluZTpub25lO2N1cnNvcjpwb2ludGVyO2ZvbnQtZmFtaWx5OnZhcigtLWZvbnQpfQoucy1pbnN0LXNlbDpmb2N1c3tib3JkZXItY29sb3I6Izk0QTNCOH0KLnMtaW5zdC1mb290e2ZvbnQtc2l6ZTouNjVyZW07Y29sb3I6dmFyKC0tc3ViMik7Zm9udC1zdHlsZTppdGFsaWM7cGFkZGluZy1sZWZ0OjUycHg7bWFyZ2luLXRvcDoycHh9Ci5zLWN1c3RvbS1hcmVhe3BhZGRpbmc6NnB4IDE2cHggMTRweDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDo2cHh9Ci5zLWN1c3RvbS1yb3d7YmFja2dyb3VuZDojRjhGQUZDO2JvcmRlci1yYWRpdXM6MTBweDtwYWRkaW5nOjEwcHggMTJweDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHh9Ci5zLWN1c3RvbS1pY29ue3dpZHRoOjI2cHg7aGVpZ2h0OjI2cHg7Ym9yZGVyLXJhZGl1czo1MCU7YmFja2dyb3VuZDojRTJFOEYwO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtmb250LXNpemU6LjY1cmVtO2ZvbnQtd2VpZ2h0OjgwMDtjb2xvcjp2YXIoLS1zdWIpO2ZsZXgtc2hyaW5rOjB9Ci5zLWN1c3RvbS1uYW1le2ZsZXg6MTtmb250LXNpemU6LjgzcmVtO2NvbG9yOnZhcigtLXN1Yik7Zm9udC13ZWlnaHQ6NTAwfQoucy1jdXN0b20taW5we3dpZHRoOjQ0cHg7Ym9yZGVyOm5vbmU7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtmb250LXNpemU6LjgzcmVtO2ZvbnQtd2VpZ2h0OjcwMDt0ZXh0LWFsaWduOnJpZ2h0O291dGxpbmU6bm9uZTtmb250LWZhbWlseTp2YXIoLS1mb250KTtjb2xvcjp2YXIoLS10ZXh0KTtwYWRkaW5nOjB9Ci5zLWN1c3RvbS1wY3R7Zm9udC1zaXplOi43NnJlbTtjb2xvcjp2YXIoLS1zdWIpfQoucy1jdXN0b20tbm90ZXtwYWRkaW5nOjAgMTZweCAxMnB4fQoucy1jdXN0b20tbm90ZSBpbnB1dHt3aWR0aDoxMDAlO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtiYWNrZ3JvdW5kOiNmZmY7Ym9yZGVyLXJhZGl1czo4cHg7cGFkZGluZzo2cHggMTBweDtmb250LXNpemU6Ljc4cmVtO291dGxpbmU6bm9uZTtmb250LWZhbWlseTp2YXIoLS1mb250KTtjb2xvcjp2YXIoLS10ZXh0KX0KLnMtY3VzdG9tLW5vdGUgaW5wdXQ6Zm9jdXN7Ym9yZGVyLWNvbG9yOiM5NEEzQjh9CiNib3RiYXItc2VudGluZWx7aGVpZ2h0OjFweDt3aWR0aDoxMDAlfQojYm90YmFye2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwuOTYpO2JhY2tkcm9wLWZpbHRlcjpibHVyKDIwcHgpOy13ZWJraXQtYmFja2Ryb3AtZmlsdGVyOmJsdXIoMjBweCk7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtwYWRkaW5nOjEwcHggMjBweCAyMHB4O29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgyMHB4KTt0cmFuc2l0aW9uOm9wYWNpdHkgLjNzIGVhc2UsdHJhbnNmb3JtIC4zcyBlYXNlO3BvaW50ZXItZXZlbnRzOm5vbmV9CiNib3RiYXIudmlzaWJsZXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCk7cG9pbnRlci1ldmVudHM6YXV0b30KLmJvdC1pbm5lcnttYXgtd2lkdGg6NDgwcHg7bWFyZ2luOjAgYXV0bztkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4fQouYm90LWFsbG9je2ZsZXg6MX0KLmJvdC1hbGxvYy1sYmx7Zm9udC1zaXplOi42MnJlbTtmb250LXdlaWdodDo3MDA7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2xldHRlci1zcGFjaW5nOi4wOGVtO2NvbG9yOnZhcigtLXN1YjIpO21hcmdpbi1ib3R0b206M3B4fQouYm90LWFsbG9jLXBjdHtmb250LXNpemU6MS40NXJlbTtmb250LXdlaWdodDo5MDA7bGV0dGVyLXNwYWNpbmc6LS4wM2VtO2NvbG9yOnZhcigtLWdyZWVuKTtsaW5lLWhlaWdodDoxO3RyYW5zaXRpb246Y29sb3IgLjNzO21hcmdpbi1ib3R0b206NXB4fQouYm90LWFsbG9jLXBjdC5jLW92ZXJ7Y29sb3I6dmFyKC0tcmVkKX0KLmJvdC10cmFja3tiYWNrZ3JvdW5kOiNFMkU4RjA7Ym9yZGVyLXJhZGl1czo5OXB4O2hlaWdodDo1cHg7b3ZlcmZsb3c6aGlkZGVuO3dpZHRoOjEwMCV9Ci5ib3QtYmFye2hlaWdodDoxMDAlO2JvcmRlci1yYWRpdXM6OTlweDtiYWNrZ3JvdW5kOnZhcigtLWdyZWVuKTt3aWR0aDowJTt0cmFuc2l0aW9uOndpZHRoIC40cyxiYWNrZ3JvdW5kIC4zc30KLmJvdC1iYXIuYy1vdmVye2JhY2tncm91bmQ6dmFyKC0tcmVkKX0KLmJ0bi1zdW1tYXJ5e2JhY2tncm91bmQ6IzBGMTcyQTtjb2xvcjojZmZmO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6MTFweDtwYWRkaW5nOjAgMThweDtoZWlnaHQ6NDZweDtmb250LXNpemU6Ljg1cmVtO2ZvbnQtd2VpZ2h0OjcwMDtjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo2cHg7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7dHJhbnNpdGlvbjpvcGFjaXR5IC4ycyx0cmFuc2Zvcm0gLjE1czt3aGl0ZS1zcGFjZTpub3dyYXB9Ci5idG4tc3VtbWFyeS5pbmFjdGl2ZXtvcGFjaXR5Oi4zNX0KLmJ0bi1zdW1tYXJ5Om5vdCguaW5hY3RpdmUpOmhvdmVye29wYWNpdHk6Ljg1O3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xcHgpfQouYnRuLXBkZntiYWNrZ3JvdW5kOnZhcigtLWdyZWVuKTtjb2xvcjojZmZmO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6MTFweDtwYWRkaW5nOjAgMTRweDtoZWlnaHQ6NDZweDtmb250LXNpemU6LjgycmVtO2ZvbnQtd2VpZ2h0OjcwMDtjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo1cHg7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7dHJhbnNpdGlvbjpvcGFjaXR5IC4yczt3aGl0ZS1zcGFjZTpub3dyYXB9Ci5idG4tcGRmLmluYWN0aXZle29wYWNpdHk6LjM1fQouYnRuLXBkZjpub3QoLmluYWN0aXZlKTpob3ZlcntvcGFjaXR5Oi44NX0KLmJ0bi1wZGYubG9hZGluZ3tvcGFjaXR5Oi43O2N1cnNvcjp3YWl0fQojZmFie3Bvc2l0aW9uOmZpeGVkO2JvdHRvbToyMHB4O3JpZ2h0OjIwcHg7d2lkdGg6NTBweDtoZWlnaHQ6NTBweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOiNmZmY7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JveC1zaGFkb3c6MCA0cHggMTJweCByZ2JhKDAsMCwwLC4xKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Y3Vyc29yOnBvaW50ZXI7ei1pbmRleDoyOTA7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gLjJzLGJveC1zaGFkb3cgLjJzO2ZvbnQtc2l6ZToxLjNyZW07Y29sb3I6dmFyKC0tdGV4dCk7bGluZS1oZWlnaHQ6MX0KI2ZhYjpob3Zlcnt0cmFuc2Zvcm06c2NhbGUoMS4wOCk7Ym94LXNoYWRvdzowIDZweCAxOHB4IHJnYmEoMCwwLDAsLjE0KX0KI2ZhYjphY3RpdmV7dHJhbnNmb3JtOnNjYWxlKC45NCl9CiNmYWItdGlwe3Bvc2l0aW9uOmZpeGVkO2JvdHRvbTozMHB4O3JpZ2h0Ojc0cHg7YmFja2dyb3VuZDojMUUyOTNCO2NvbG9yOiNmZmY7Zm9udC1zaXplOi42OHJlbTtmb250LXdlaWdodDo2MDA7Zm9udC1mYW1pbHk6dmFyKC0tZm9udCk7cGFkZGluZzo1cHggMTBweDtib3JkZXItcmFkaXVzOjdweDt3aGl0ZS1zcGFjZTpub3dyYXA7cG9pbnRlci1ldmVudHM6bm9uZTtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoNHB4KTt0cmFuc2l0aW9uOm9wYWNpdHkgLjE4cyx0cmFuc2Zvcm0gLjE4czt6LWluZGV4OjI5MX0KI2ZhYi10aXA6OmFmdGVye2NvbnRlbnQ6Jyc7cG9zaXRpb246YWJzb2x1dGU7dG9wOjUwJTtyaWdodDotNXB4O3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpO2JvcmRlcjo1cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWxlZnQtY29sb3I6IzFFMjkzQjtib3JkZXItcmlnaHQ6bm9uZX0KI2ZhYjpob3ZlciArICNmYWItdGlwe29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgwKX0KI3RvYXN0e3Bvc2l0aW9uOmZpeGVkO2JvdHRvbToyNHB4O2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoOHB4KTtiYWNrZ3JvdW5kOiMxRTI5M0I7Y29sb3I6I2ZmZjtib3JkZXItcmFkaXVzOjEwcHg7cGFkZGluZzoxMHB4IDE4cHg7Zm9udC1zaXplOi43OHJlbTtsaW5lLWhlaWdodDoxLjY7bWF4LXdpZHRoOjM0MHB4O3dpZHRoOmNhbGMoMTAwJSAtIDQwcHgpO2JveC1zaGFkb3c6MCA4cHggMzJweCByZ2JhKDAsMCwwLC4yKTtwb2ludGVyLWV2ZW50czpub25lO29wYWNpdHk6MDt0cmFuc2l0aW9uOm9wYWNpdHkgLjIycyx0cmFuc2Zvcm0gLjIyczt6LWluZGV4OjQwMDt3aGl0ZS1zcGFjZTpwcmUtbGluZTt0ZXh0LWFsaWduOmNlbnRlcn0KI3RvYXN0LnNob3d7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoMCl9CiNyZXNldE92ZXJsYXl7ZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO2luc2V0OjA7YmFja2dyb3VuZDpyZ2JhKDE1LDIzLDQyLC40NSk7ei1pbmRleDo2MDA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7cGFkZGluZzoyMHB4fQojcmVzZXRPdmVybGF5LnNob3d7ZGlzcGxheTpmbGV4fQojcmVzZXREaWFsb2d7YmFja2dyb3VuZDojZmZmO2JvcmRlci1yYWRpdXM6MTZweDtwYWRkaW5nOjI0cHggMjBweCAyMHB4O3dpZHRoOjEwMCU7bWF4LXdpZHRoOjMyMHB4O2JveC1zaGFkb3c6MCAyMHB4IDYwcHggcmdiYSgwLDAsMCwuMTgpO3RleHQtYWxpZ246Y2VudGVyfQoucmQtaWNvbntmb250LXNpemU6MnJlbTttYXJnaW4tYm90dG9tOjEwcHg7bGluZS1oZWlnaHQ6MX0KLnJkLXRpdGxle2ZvbnQtc2l6ZToxcmVtO2ZvbnQtd2VpZ2h0OjgwMDtjb2xvcjp2YXIoLS10ZXh0KTttYXJnaW4tYm90dG9tOjZweH0KLnJkLXN1Yntmb250LXNpemU6Ljc4cmVtO2NvbG9yOnZhcigtLXN1Yik7bGluZS1oZWlnaHQ6MS41O21hcmdpbi1ib3R0b206MjBweH0KLnJkLWJ0bnN7ZGlzcGxheTpmbGV4O2dhcDoxMHB4fQoucmQtY2FuY2Vse2ZsZXg6MTtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo5cHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JhY2tncm91bmQ6I0Y4RkFGQztjb2xvcjp2YXIoLS1zdWIpO2ZvbnQtc2l6ZTouODRyZW07Zm9udC13ZWlnaHQ6NzAwO2N1cnNvcjpwb2ludGVyO2ZvbnQtZmFtaWx5OnZhcigtLWZvbnQpO3RyYW5zaXRpb246YmFja2dyb3VuZCAuMTVzfQoucmQtY2FuY2VsOmhvdmVye2JhY2tncm91bmQ6I0YxRjVGOX0KLnJkLWNvbmZpcm17ZmxleDoxO3BhZGRpbmc6MTBweDtib3JkZXItcmFkaXVzOjlweDtib3JkZXI6bm9uZTtiYWNrZ3JvdW5kOiNFMTFENDg7Y29sb3I6I2ZmZjtmb250LXNpemU6Ljg0cmVtO2ZvbnQtd2VpZ2h0OjcwMDtjdXJzb3I6cG9pbnRlcjtmb250LWZhbWlseTp2YXIoLS1mb250KTt0cmFuc2l0aW9uOm9wYWNpdHkgLjE1cyx0cmFuc2Zvcm0gLjE1c30KLnJkLWNvbmZpcm06aG92ZXJ7b3BhY2l0eTouODg7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTFweCl9CiNvdmVybGF5e2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgxNSwyMyw0MiwuNSk7ei1pbmRleDo1MDA7YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KI292ZXJsYXkuc2hvd3tkaXNwbGF5OmZsZXh9CiNtb2RhbHtiYWNrZ3JvdW5kOiNmZmY7Ym9yZGVyLXJhZGl1czoyMHB4IDIwcHggMCAwO3dpZHRoOjEwMCU7bWF4LXdpZHRoOjQ4MHB4O21heC1oZWlnaHQ6ODh2aDtvdmVyZmxvdy15OmF1dG87cGFkZGluZy1ib3R0b206ZW52KHNhZmUtYXJlYS1pbnNldC1ib3R0b20sMjBweCl9Ci5tLWhhbmRsZXt3aWR0aDozNnB4O2hlaWdodDo0cHg7YmFja2dyb3VuZDojRTJFOEYwO2JvcmRlci1yYWRpdXM6OTlweDttYXJnaW46MTBweCBhdXRvIDE0cHh9Ci5tLWhkcntwYWRkaW5nOjAgMjBweCAxNHB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Ym9yZGVyLWJvdHRvbToxcHggc29saWQgI0YxRjVGOX0KLm0tdGl0bGV7Zm9udC1zaXplOjFyZW07Zm9udC13ZWlnaHQ6ODAwO2xldHRlci1zcGFjaW5nOi0uMDFlbX0KLm0tY2xvc2V7YmFja2dyb3VuZDpub25lO2JvcmRlcjpub25lO2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxLjNyZW07Y29sb3I6dmFyKC0tc3ViKTtsaW5lLWhlaWdodDoxO3BhZGRpbmc6MnB4IDRweH0KLm0tYm9keXtwYWRkaW5nOjE2cHggMjBweH0KLm0tbWV0YXtmb250LXNpemU6Ljc2cmVtO2NvbG9yOnZhcigtLXN1Yik7bWFyZ2luLWJvdHRvbToxNHB4fQoubS1tZXRhIGJ7Y29sb3I6IzBGMTcyQTtmb250LXdlaWdodDo3MDB9Ci5tLXBibG9ja3ttYXJnaW4tYm90dG9tOjE0cHg7Ym9yZGVyLXJhZGl1czoxMnB4O292ZXJmbG93OmhpZGRlbjtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcil9Ci5tLXBoZHJ7cGFkZGluZzo5cHggMTRweDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Zm9udC13ZWlnaHQ6NzAwO2ZvbnQtc2l6ZTouODVyZW07Y29sb3I6I2ZmZn0KLm0tc3Vic3tiYWNrZ3JvdW5kOiNGOEZBRkN9Ci5tLXNyb3d7cGFkZGluZzo4cHggMTRweCA4cHggMThweDtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6ZmxleC1zdGFydDtib3JkZXItYm90dG9tOjFweCBzb2xpZCAjRjFGNUY5fQoubS1zcm93Omxhc3QtY2hpbGR7Ym9yZGVyLWJvdHRvbTpub25lfQoubS1zbmFtZXtmb250LXNpemU6Ljc5cmVtO2ZvbnQtd2VpZ2h0OjcwMDtjb2xvcjojMUUyOTNCfQoubS1zaW5zdHtmb250LXNpemU6LjdyZW07Y29sb3I6dmFyKC0tc3ViKTttYXJnaW4tdG9wOjJweH0KLm0tc3d0e2ZvbnQtc2l6ZTouODVyZW07Zm9udC13ZWlnaHQ6ODAwO2NvbG9yOiMwRjE3MkE7cGFkZGluZy1sZWZ0OjEwcHg7d2hpdGUtc3BhY2U6bm93cmFwfQoubS1lbXB0eXtwYWRkaW5nOjdweCAxOHB4O2ZvbnQtc2l6ZTouNzRyZW07Y29sb3I6Izk0QTNCODtmb250LXN0eWxlOml0YWxpY30KLm0tdG90YWx7bWFyZ2luLXRvcDoxMHB4O3BhZGRpbmc6MTFweCAxNHB4O2JhY2tncm91bmQ6I0VDRkRGNTtib3JkZXItcmFkaXVzOjEwcHg7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2ZvbnQtd2VpZ2h0OjgwMDtmb250LXNpemU6LjkycmVtO2NvbG9yOiMwNjVGNDZ9Cjwvc3R5bGU+CjwvaGVhZD48Ym9keT4KPGRpdiBzdHlsZT0iaGVpZ2h0OmVudihzYWZlLWFyZWEtaW5zZXQtdG9wLDBweCk7YmFja2dyb3VuZDojZmZmIj48L2Rpdj4KPGRpdiBpZD0idG9wYmFyIj4KICA8ZGl2IGNsYXNzPSJ0Yi1yb3cxIj4KICAgIDxkaXY+PGRpdiBjbGFzcz0idGItdGl0bGUiPlBvcnRmb2xpbyBDb25zdHJ1Y3RvcjwvZGl2PjxkaXYgY2xhc3M9InRiLXN1YiI+QXNzZXQgYWxsb2NhdGlvbjwvZGl2PjwvZGl2PgogICAgPGJ1dHRvbiBpZD0iYnRuUmVzZXQiPiYjeDIxQkE7IFJlc2V0PC9idXR0b24+CiAgPC9kaXY+CiAgPGRpdiBjbGFzcz0idGItbmFtZS1yb3ciPgogICAgPGxhYmVsIGNsYXNzPSJ0Yi1uYW1lLWxibCIgZm9yPSJwbmFtZSI+TmFtZTwvbGFiZWw+CiAgICA8aW5wdXQgaWQ9InBuYW1lIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iZS5nLiBSZXRpcmVtZW50IDIwNDUiIGF1dG9jb21wbGV0ZT0ib2ZmIi8+CiAgPC9kaXY+CjwvZGl2Pgo8ZGl2IGlkPSJwcm9nLXdyYXAiPjxkaXYgaWQ9InByb2ctaW5uZXIiPgogIDxkaXYgY2xhc3M9InByb2ctcm93Ij48c3BhbiBjbGFzcz0icHJvZy1sYmwtdHh0Ij5Bc3NldCBBbGxvY2F0aW9uIFByb2dyZXNzPC9zcGFuPjxzcGFuIGlkPSJwcm9nUGN0Ij4wLjAlPC9zcGFuPjwvZGl2PgogIDxkaXYgY2xhc3M9InByb2ctdHJhY2siPjxkaXYgaWQ9InByb2dCYXIiPjwvZGl2PjwvZGl2PgogIDxkaXYgaWQ9InByb2dTdGF0dXMiPkZpbGwgaW4gdGhlIHdlaWdodCBmb3IgZWFjaCBhc3NldCBjbGFzcyB0byBiZWdpbi48L2Rpdj4KPC9kaXY+PC9kaXY+CjxkaXYgaWQ9Im1haW4iPjxkaXYgaWQ9ImJ1aWxkZXIiPjwvZGl2PjwvZGl2Pgo8ZGl2IGlkPSJib3RiYXItc2VudGluZWwiPjwvZGl2Pgo8ZGl2IGlkPSJib3RiYXIiPjxkaXYgY2xhc3M9ImJvdC1pbm5lciI+CiAgPGRpdiBjbGFzcz0iYm90LWFsbG9jIj4KICAgIDxkaXYgY2xhc3M9ImJvdC1hbGxvYy1sYmwiPlRvdGFsIEFsbG9jYXRpb248L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImJvdC1hbGxvYy1wY3QiIGlkPSJib3RQY3QiPjAuMCU8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImJvdC10cmFjayI+PGRpdiBjbGFzcz0iYm90LWJhciIgaWQ9ImJvdEJhciI+PC9kaXY+PC9kaXY+CiAgPC9kaXY+CiAgPGJ1dHRvbiBjbGFzcz0iYnRuLXN1bW1hcnkgaW5hY3RpdmUiIGlkPSJidG5TdW1tYXJ5Ij4mI3gxRjRDQjsgU3VtbWFyeTwvYnV0dG9uPgogIDxidXR0b24gY2xhc3M9ImJ0bi1wZGYgaW5hY3RpdmUiIGlkPSJidG5FeHBvcnQiPiYjeDJCMDc7IFBERjwvYnV0dG9uPgo8L2Rpdj48L2Rpdj4KPGJ1dHRvbiBpZD0iZmFiIiB0aXRsZT0iRXhwYW5kIGFsbCI+KzwvYnV0dG9uPjxkaXYgaWQ9ImZhYi10aXAiPkV4cGFuZCBhbGw8L2Rpdj4KPGRpdiBpZD0idG9hc3QiPjwvZGl2Pgo8ZGl2IGlkPSJyZXNldE92ZXJsYXkiPgogIDxkaXYgaWQ9InJlc2V0RGlhbG9nIj4KICAgIDxkaXYgY2xhc3M9InJkLWljb24iPiYjeDI2QTA7JiN4RkUwRjs8L2Rpdj4KICAgIDxkaXYgY2xhc3M9InJkLXRpdGxlIj5SZXNldCBhbGwgd2VpZ2h0cz88L2Rpdj4KICAgIDxkaXYgY2xhc3M9InJkLXN1YiI+VGhpcyB3aWxsIGNsZWFyIGFsbCBhbGxvY2F0aW9ucywgaW5zdHJ1bWVudCBzZWxlY3Rpb25zLCBhbmQgdGhlIHBvcnRmb2xpbyBuYW1lLiBUaGlzIGNhbm5vdCBiZSB1bmRvbmUuPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJyZC1idG5zIj4KICAgICAgPGJ1dHRvbiBjbGFzcz0icmQtY2FuY2VsIiBpZD0icmRDYW5jZWwiPkNhbmNlbDwvYnV0dG9uPgogICAgICA8YnV0dG9uIGNsYXNzPSJyZC1jb25maXJtIiBpZD0icmRDb25maXJtIj5ZZXMsIHJlc2V0PC9idXR0b24+CiAgICA8L2Rpdj4KICA8L2Rpdj4KPC9kaXY+CjxkaXYgaWQ9Im92ZXJsYXkiPjxkaXYgaWQ9Im1vZGFsIj4KICA8ZGl2IGNsYXNzPSJtLWhhbmRsZSI+PC9kaXY+CiAgPGRpdiBjbGFzcz0ibS1oZHIiPjxzcGFuIGNsYXNzPSJtLXRpdGxlIj4mI3gxRjRDQjsgUG9ydGZvbGlvIFN1bW1hcnk8L3NwYW4+PGJ1dHRvbiBjbGFzcz0ibS1jbG9zZSIgaWQ9ImJ0bkNsb3NlIj4mdGltZXM7PC9idXR0b24+PC9kaXY+CiAgPGRpdiBjbGFzcz0ibS1ib2R5IiBpZD0ibW9kYWxCb2R5Ij48L2Rpdj4KPC9kaXY+PC9kaXY+Cgo8IS0tIENETiBsaWJzIGxvYWRlZCBsYXppbHkgb25seSB3aGVuIFBERiBpcyByZXF1ZXN0ZWQgLS0+CjxzY3JpcHQ+CnZhciBGVU5EUz0lJUZVTkRTX0pTT04lJTsKdmFyIFNUUlVDVFVSRT0lJVNUUlVDVFVSRV9KUyUlOwp2YXIgcFc9e30sc1c9e30saW5zPXt9LGNUeHQ9e30scE9wZW49e30sc09wZW49e30sdG9hc3RUaW1lcj1udWxsLGFsbEV4cGFuZGVkPWZhbHNlOwp2YXIgQUNDRU5UPVsKICB7YmFyOicjM0I4MkY2JyxwYjonI0VGRjZGRicscHQ6JyMyNTYzRUInfSwKICB7YmFyOicjRTI3RDYwJyxwYjonI0ZGRjdFRCcscHQ6JyNDMjYyMkUnfSwKICB7YmFyOicjQTg1NUY3JyxwYjonI0ZBRjVGRicscHQ6JyM5MzMzRUEnfSwKICB7YmFyOicjNjM2NkYxJyxwYjonI0VFRjJGRicscHQ6JyM0RjQ2RTUnfSwKICB7YmFyOicjRjU5RTBCJyxwYjonI0ZGRkJFQicscHQ6JyNEOTc3MDYnfSwKICB7YmFyOicjMTBCOTgxJyxwYjonI0VDRkRGNScscHQ6JyMwNTk2NjknfSwKICB7YmFyOicjRjQzRjVFJyxwYjonI0ZGRjFGMicscHQ6JyNFMTFENDgnfSwKICB7YmFyOicjMTRCOEE2JyxwYjonI0YwRkRGQScscHQ6JyMwRDk0ODgnfQpdOwpmdW5jdGlvbiBhYyhwaSl7cmV0dXJuIEFDQ0VOVFtwaSVBQ0NFTlQubGVuZ3RoXTt9CmZ1bmN0aW9uIHIxKHYpe3JldHVybiBNYXRoLnJvdW5kKHYqMTApLzEwO30KZnVuY3Rpb24gbWtFbCh0LGMpe3ZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCk7aWYoYyllLmNsYXNzTmFtZT1jO3JldHVybiBlO30KZnVuY3Rpb24gbWtOdW0oYyxwaCl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtlLnR5cGU9J251bWJlcic7ZS5jbGFzc05hbWU9YztlLnNldEF0dHJpYnV0ZSgnbWluJywnMCcpO2Uuc2V0QXR0cmlidXRlKCdtYXgnLCcxMDAnKTtlLnNldEF0dHJpYnV0ZSgnc3RlcCcsJzAuMScpO2UucGxhY2Vob2xkZXI9cGh8fCcwJztyZXR1cm4gZTt9CgovKiDilIDilIAgQm90YmFyIHNlbnRpbmVsIOKUgOKUgCAqLwooZnVuY3Rpb24oKXsKICB2YXIgcz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm90YmFyLXNlbnRpbmVsJyksYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm90YmFyJyk7CiAgaWYoIXN8fCFiKXJldHVybjsKICBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oZW4pe2VuLmZvckVhY2goZnVuY3Rpb24oZSl7Yi5jbGFzc0xpc3QudG9nZ2xlKCd2aXNpYmxlJyxlLmlzSW50ZXJzZWN0aW5nKTt9KTt9LHt0aHJlc2hvbGQ6MH0pLm9ic2VydmUocyk7Cn0pKCk7CgovKiDilIDilIAgQnVpbGQgVUkg4pSA4pSAICovCmZ1bmN0aW9uIGJ1aWxkVUkoKXsKICB2YXIgYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVpbGRlcicpO2IuaW5uZXJIVE1MPScnOwogIGZvcih2YXIgcGk9MDtwaTxTVFJVQ1RVUkUubGVuZ3RoO3BpKyspewogICAgdmFyIHA9U1RSVUNUVVJFW3BpXSxhPWFjKHBpKTsKICAgIHBPcGVuW3AuaWRdPWZhbHNlO3BXW3AuaWRdPW51bGw7CiAgICB2YXIgY2FyZD1ta0VsKCdkaXYnLCdwLWNhcmQnKTtjYXJkLmlkPSdwY2FyZF8nK3AuaWQ7CiAgICB2YXIgaGVhZD1ta0VsKCdkaXYnLCdwLWhlYWQnKTsKICAgIHZhciBobD1ta0VsKCdkaXYnLCdwLWhlYWQtbGVmdCcpOwogICAgdmFyIGNiPW1rRWwoJ2RpdicsJ3AtY29sb3JiYXInKTtjYi5zdHlsZS5iYWNrZ3JvdW5kPWEuYmFyOwogICAgdmFyIG53PW1rRWwoJ2RpdicsJycpOwogICAgdmFyIG5tPW1rRWwoJ2RpdicsJ3AtbmFtZScpO25tLnRleHRDb250ZW50PXAubmFtZTsKICAgIHZhciB0ZT1ta0VsKCdkaXYnLCdwLXRhbGx5LWVycicpO3RlLmlkPSd0ZXJyXycrcC5pZDt0ZS50ZXh0Q29udGVudD0nXHUyNmEwIHN1Yi13ZWlnaHRzIGRvblwndCBhZGQgdXAnOwogICAgbncuYXBwZW5kQ2hpbGQobm0pO253LmFwcGVuZENoaWxkKHRlKTsKICAgIGhsLmFwcGVuZENoaWxkKGNiKTtobC5hcHBlbmRDaGlsZChudyk7CiAgICB2YXIgaHI9bWtFbCgnZGl2JywnJyk7aHIuc3R5bGUuY3NzVGV4dD0nZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6NnB4JzsKICAgIHZhciBwaWxsPW1rRWwoJ2RpdicsJ3AtcGlsbCcpO3BpbGwuc3R5bGUuYmFja2dyb3VuZD1hLnBiO3BpbGwuc3R5bGUuY29sb3I9YS5wdDsKICAgIHZhciBwcj1ta0VsKCdkaXYnLCdwLWlucC1yb3cnKTsKICAgIHZhciBwaW5wPW1rTnVtKCdwLWlucCcsJzAnKTtwaW5wLmlkPSdwaW5wXycrcC5pZDtwaW5wLnN0eWxlLmNvbG9yPWEucHQ7CiAgICB2YXIgcHN5bT1ta0VsKCdzcGFuJywncC1wY3Qtc3ltJyk7cHN5bS50ZXh0Q29udGVudD0nJSc7cHN5bS5zdHlsZS5jb2xvcj1hLnB0OwogICAgcHIuYXBwZW5kQ2hpbGQocGlucCk7cHIuYXBwZW5kQ2hpbGQocHN5bSk7cGlsbC5hcHBlbmRDaGlsZChwcik7CiAgICB2YXIgY2g9bWtFbCgnc3BhbicsJ3AtY2hldicpO2NoLmlkPSdwY2hldl8nK3AuaWQ7Y2gudGV4dENvbnRlbnQ9J1x1MjViZSc7CiAgICBoci5hcHBlbmRDaGlsZChwaWxsKTtoci5hcHBlbmRDaGlsZChjaCk7CiAgICBoZWFkLmFwcGVuZENoaWxkKGhsKTtoZWFkLmFwcGVuZENoaWxkKGhyKTsKICAgIGF0dGFjaFBhcmVudEhlYWQocC5pZCxwaW5wLGhlYWQpOwogICAgY2FyZC5hcHBlbmRDaGlsZChoZWFkKTsKICAgIHZhciBzZWM9bWtFbCgnZGl2Jywncy1zZWN0aW9uJyk7c2VjLmlkPSdzZWNfJytwLmlkOwogICAgZm9yKHZhciBzaT0wO3NpPHAuc3Vicy5sZW5ndGg7c2krKyl7CiAgICAgIHZhciBzPXAuc3Vic1tzaV07c1dbcy5pZF09bnVsbDsKICAgICAgaWYocy5jdXN0b20pc2VjLmFwcGVuZENoaWxkKGJ1aWxkQ3VzdG9tUm93KHMpKTsKICAgICAgZWxzZXtzT3BlbltzLmlkXT1mYWxzZTtzZWMuYXBwZW5kQ2hpbGQoYnVpbGRTdWJSb3cocykpO30KICAgIH0KICAgIGNhcmQuYXBwZW5kQ2hpbGQoc2VjKTtiLmFwcGVuZENoaWxkKGNhcmQpOwogIH0KfQpmdW5jdGlvbiBhdHRhY2hQYXJlbnRIZWFkKHBpZCxwaW5wLGhlYWQpewogIHBpbnAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7fSk7CiAgcGlucC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsZnVuY3Rpb24oKXt2YXIgdj1wYXJzZUZsb2F0KHRoaXMudmFsdWUpO3BXW3BpZF09aXNOYU4odik/bnVsbDpyMSh2KTt2YWxpZGF0ZSgpO30pOwogIGhlYWQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7dG9nZ2xlUChwaWQpO3VwZGF0ZUZhYlN0YXRlKCk7fSk7Cn0KZnVuY3Rpb24gYnVpbGRTdWJSb3cocyl7CiAgdmFyIHdyYXA9bWtFbCgnZGl2JywnJyk7CiAgdmFyIGZkPShGVU5EUy5zdWJfYXNzZXRzJiZGVU5EUy5zdWJfYXNzZXRzW3MuZmtdKT9GVU5EUy5zdWJfYXNzZXRzW3MuZmtdOntyZWNvbW1lbmRlZDpbXSxhbGw6W119OwogIHZhciByZWNDPShmZC5yZWNvbW1lbmRlZCYmZmQucmVjb21tZW5kZWQubGVuZ3RoKT9mZC5yZWNvbW1lbmRlZC5sZW5ndGg6MDsKICB2YXIgYWxsQz0oZmQuYWxsJiZmZC5hbGwubGVuZ3RoKT9mZC5hbGwubGVuZ3RoOjA7CiAgdmFyIGhhc0Z1bmRzPShyZWNDK2FsbEMpPjA7CiAgdmFyIGxhPW1rRWwoJ2RpdicsJ3MtbGlzdC1hcmVhJyk7CiAgdmFyIHJvdz1ta0VsKCdkaXYnLCdzLWxpc3Qtcm93Jyk7CiAgdmFyIGxsPW1rRWwoJ2RpdicsJ3MtbGlzdC1sZWZ0Jyk7CiAgdmFyIGxubT1ta0VsKCdzcGFuJywncy1saXN0LW5hbWUnKTtsbm0udGV4dENvbnRlbnQ9cy5uYW1lO2xsLmFwcGVuZENoaWxkKGxubSk7CiAgaWYoaGFzRnVuZHMpewogICAgdmFyIGViPW1rRWwoJ2J1dHRvbicsJ3MtZXhwYW5kLWJ0bicpO2ViLnR5cGU9J2J1dHRvbic7CiAgICB2YXIgZWQ9bWtFbCgnc3BhbicsJ3MtZXhwYW5kLWRvdCcpO2VkLmlkPSdlZG90Xycrcy5pZDsKICAgIGVkLmlubmVySFRNTD0nPHN2ZyB2aWV3Qm94PSIwIDAgMTAgNiI+PHBvbHlsaW5lIHBvaW50cz0iMSwxIDUsNSA5LDEiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzk0QTNCOCIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48L3N2Zz4nOwogICAgZWIuYXBwZW5kQ2hpbGQoZWQpOwogICAgZWIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKGUpe2Uuc3RvcFByb3BhZ2F0aW9uKCk7dG9nZ2xlU0luc3Qocy5pZCk7fSk7CiAgICBsbC5hcHBlbmRDaGlsZChlYik7CiAgfQogIHZhciBscj1ta0VsKCdkaXYnLCdzLWxpc3QtcmlnaHQnKTsKICB2YXIgc2lucD1ta051bSgncy1saXN0LWlucCcsJzAnKTtzaW5wLmlkPSdzaW5wXycrcy5pZDsKICB2YXIgc3A9bWtFbCgnc3BhbicsJ3MtbGlzdC1wY3QnKTtzcC50ZXh0Q29udGVudD0nJSc7CiAgbHIuYXBwZW5kQ2hpbGQoc2lucCk7bHIuYXBwZW5kQ2hpbGQoc3ApOwogIHJvdy5hcHBlbmRDaGlsZChsbCk7cm93LmFwcGVuZENoaWxkKGxyKTsKICBsYS5hcHBlbmRDaGlsZChyb3cpO2F0dGFjaFN1YklucChzLmlkLHNpbnApO3dyYXAuYXBwZW5kQ2hpbGQobGEpOwogIGlmKGhhc0Z1bmRzKXsKICAgIHZhciBpYT1ta0VsKCdkaXYnLCdzLWluc3QtYXJlYScpO2lhLmlkPSdpYXJlYV8nK3MuaWQ7CiAgICB2YXIgbnI9TWF0aC5taW4ocmVjQythbGxDLDMpOwogICAgZm9yKHZhciBpPTA7aTxucjtpKyspewogICAgICB2YXIgaXI9bWtFbCgnZGl2Jywncy1pbnN0LXJvdycpOwogICAgICB2YXIgaWw9bWtFbCgnc3BhbicsJ3MtaW5zdC1sYmwnKTtpbC50ZXh0Q29udGVudD0nRnVuZCAnKyhpKzEpOwogICAgICB2YXIgc2VsPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO3NlbC5jbGFzc05hbWU9J3MtaW5zdC1zZWwnO3NlbC5pZD0naW5zdF8nK3MuaWQrJ18nK2k7CiAgICAgIHZhciBkb3A9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7ZG9wLnZhbHVlPScnO2RvcC50ZXh0Q29udGVudD1pPT09MD8nXHUyMDE0IFNlbGVjdCBcdTIwMTQnOidcdTIwMTQgQWRkIGFub3RoZXIgXHUyMDE0JztzZWwuYXBwZW5kQ2hpbGQoZG9wKTsKICAgICAgaWYocmVjQz4wKXt2YXIgZzE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0Z3JvdXAnKTtnMS5sYWJlbD0nXHUyNjA1IFJlY29tbWVuZGVkJztmb3IodmFyIHI9MDtyPGZkLnJlY29tbWVuZGVkLmxlbmd0aDtyKyspe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO28udmFsdWU9ZmQucmVjb21tZW5kZWRbcl07by50ZXh0Q29udGVudD1mZC5yZWNvbW1lbmRlZFtyXTtnMS5hcHBlbmRDaGlsZChvKTt9c2VsLmFwcGVuZENoaWxkKGcxKTt9CiAgICAgIGlmKGFsbEM+MCl7dmFyIGcyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGdyb3VwJyk7ZzIubGFiZWw9J0FsbCBGdW5kcyc7Zm9yKHZhciByMj0wO3IyPGZkLmFsbC5sZW5ndGg7cjIrKyl7dmFyIG8yPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO28yLnZhbHVlPWZkLmFsbFtyMl07bzIudGV4dENvbnRlbnQ9ZmQuYWxsW3IyXTtnMi5hcHBlbmRDaGlsZChvMik7fXNlbC5hcHBlbmRDaGlsZChnMik7fQogICAgICBhdHRhY2hTZWwocy5pZCxzZWwpO2lyLmFwcGVuZENoaWxkKGlsKTtpci5hcHBlbmRDaGlsZChzZWwpO2lhLmFwcGVuZENoaWxkKGlyKTsKICAgIH0KICAgIHZhciBmdD1ta0VsKCdkaXYnLCdzLWluc3QtZm9vdCcpO2Z0LnRleHRDb250ZW50PSdPcHRpb25hbCBcdTIwMTQgdXAgdG8gJytucisnIGluc3RydW1lbnQnKyhucj4xPydzJzonJyk7CiAgICBpYS5hcHBlbmRDaGlsZChmdCk7d3JhcC5hcHBlbmRDaGlsZChpYSk7CiAgfQogIHJldHVybiB3cmFwOwp9CmZ1bmN0aW9uIGF0dGFjaFN1YklucChzaWQsc2lucCl7CiAgc2lucC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oZSl7ZS5zdG9wUHJvcGFnYXRpb24oKTt9KTsKICBzaW5wLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JyxmdW5jdGlvbigpe3ZhciB2PXBhcnNlRmxvYXQodGhpcy52YWx1ZSk7c1dbc2lkXT1pc05hTih2KT9udWxsOnIxKHYpO3ZhbGlkYXRlKCk7fSk7Cn0KZnVuY3Rpb24gYXR0YWNoU2VsKHNpZCxzZWwpewogIHNlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLGZ1bmN0aW9uKCl7CiAgICB2YXIgcD1bXTtmb3IodmFyIGk9MDtpPDM7aSsrKXt2YXIgZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdF8nK3NpZCsnXycraSk7aWYoZSYmZS52YWx1ZSlwLnB1c2goZS52YWx1ZSk7fWluc1tzaWRdPXA7CiAgfSk7Cn0KZnVuY3Rpb24gYnVpbGRDdXN0b21Sb3cocyl7CiAgdmFyIHdyYXA9bWtFbCgnZGl2JywnJyk7CiAgdmFyIGNhPW1rRWwoJ2RpdicsJ3MtY3VzdG9tLWFyZWEnKTsKICB2YXIgcm93PW1rRWwoJ2RpdicsJ3MtY3VzdG9tLXJvdycpOwogIHZhciBpY29uPW1rRWwoJ2RpdicsJ3MtY3VzdG9tLWljb24nKTtpY29uLnRleHRDb250ZW50PSdcdTI3MzYnOwogIHZhciBubT1ta0VsKCdzcGFuJywncy1jdXN0b20tbmFtZScpO25tLnRleHRDb250ZW50PXMubmFtZTsKICB2YXIgc2lucD1ta051bSgncy1jdXN0b20taW5wJywnMCcpO3NpbnAuaWQ9J3NpbnBfJytzLmlkOwogIHZhciBwY3Q9bWtFbCgnc3BhbicsJ3MtY3VzdG9tLXBjdCcpO3BjdC50ZXh0Q29udGVudD0nJSc7CiAgcm93LmFwcGVuZENoaWxkKGljb24pO3Jvdy5hcHBlbmRDaGlsZChubSk7cm93LmFwcGVuZENoaWxkKHNpbnApO3Jvdy5hcHBlbmRDaGlsZChwY3QpOwogIGNhLmFwcGVuZENoaWxkKHJvdyk7YXR0YWNoU3ViSW5wKHMuaWQsc2lucCk7d3JhcC5hcHBlbmRDaGlsZChjYSk7CiAgdmFyIG5hPW1rRWwoJ2RpdicsJ3MtY3VzdG9tLW5vdGUnKTsKICB2YXIgbmk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtuaS50eXBlPSd0ZXh0JztuaS5wbGFjZWhvbGRlcj0nTm90ZXMgLyBkZXNjcmlwdGlvblx1MjAyNic7bmkuaWQ9J2N0eHRfJytzLmlkOwogIG5pLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JyxmdW5jdGlvbigpe2NUeHRbcy5pZF09dGhpcy52YWx1ZTt9KTsKICBuYS5hcHBlbmRDaGlsZChuaSk7d3JhcC5hcHBlbmRDaGlsZChuYSk7CiAgcmV0dXJuIHdyYXA7Cn0KZnVuY3Rpb24gdG9nZ2xlUChwaWQpewogIHBPcGVuW3BpZF09IXBPcGVuW3BpZF07CiAgdmFyIHNlYz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VjXycrcGlkKSxjaD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGNoZXZfJytwaWQpOwogIGlmKHNlYylzZWMuY2xhc3NOYW1lPSdzLXNlY3Rpb24nKyhwT3BlbltwaWRdPycgb3Blbic6JycpOwogIGlmKGNoKWNoLmNsYXNzTmFtZT0ncC1jaGV2JysocE9wZW5bcGlkXT8nIG9wZW4nOicnKTsKfQpmdW5jdGlvbiB0b2dnbGVTSW5zdChzaWQpewogIHNPcGVuW3NpZF09IXNPcGVuW3NpZF07CiAgdmFyIGE9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lhcmVhXycrc2lkKSxkPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZG90Xycrc2lkKTsKICBpZihhKWEuY2xhc3NOYW1lPSdzLWluc3QtYXJlYScrKHNPcGVuW3NpZF0/JyBvcGVuJzonJyk7CiAgaWYoZClkLmNsYXNzTmFtZT0ncy1leHBhbmQtZG90Jysoc09wZW5bc2lkXT8nIG9wZW4nOicnKTsKfQpmdW5jdGlvbiB1cGRhdGVGYWJTdGF0ZSgpewogIHZhciBhbnk9ZmFsc2U7CiAgZm9yKHZhciBpPTA7aTxTVFJVQ1RVUkUubGVuZ3RoO2krKyl7aWYocE9wZW5bU1RSVUNUVVJFW2ldLmlkXSl7YW55PXRydWU7YnJlYWs7fX0KICBhbGxFeHBhbmRlZD1hbnk7CiAgdmFyIGZhYj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmFiJyksdGlwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmYWItdGlwJyk7CiAgZmFiLnRleHRDb250ZW50PWFsbEV4cGFuZGVkPydcdTIyMTInOicrJzsKICBpZih0aXApdGlwLnRleHRDb250ZW50PWFsbEV4cGFuZGVkPydDb2xsYXBzZSBhbGwnOidFeHBhbmQgYWxsJzsKfQpmdW5jdGlvbiBmYWJUb2dnbGVBbGwoKXsKICB2YXIgb3Blbj0hYWxsRXhwYW5kZWQ7CiAgZm9yKHZhciBpPTA7aTxTVFJVQ1RVUkUubGVuZ3RoO2krKyl7CiAgICB2YXIgcGlkPVNUUlVDVFVSRVtpXS5pZDtwT3BlbltwaWRdPW9wZW47CiAgICB2YXIgc2VjPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWNfJytwaWQpLGNoPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwY2hldl8nK3BpZCk7CiAgICBpZihzZWMpc2VjLmNsYXNzTmFtZT0ncy1zZWN0aW9uJysob3Blbj8nIG9wZW4nOicnKTsKICAgIGlmKGNoKWNoLmNsYXNzTmFtZT0ncC1jaGV2Jysob3Blbj8nIG9wZW4nOicnKTsKICB9CiAgYWxsRXhwYW5kZWQ9b3Blbjt1cGRhdGVGYWJTdGF0ZSgpOwogIGlmKG9wZW4pd2luZG93LnNjcm9sbFRvKHt0b3A6MCxiZWhhdmlvcjonc21vb3RoJ30pOwp9CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmYWInKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZmFiVG9nZ2xlQWxsKTsKCi8qIOKUgOKUgCBSZXNldCDilIDilIAgKi8KZnVuY3Rpb24gb3BlblJlc2V0RGlhbG9nKCl7dmFyIHJvPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldE92ZXJsYXknKTtyby5zdHlsZS5kaXNwbGF5PSdmbGV4JztyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKXtyby5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7fSk7fQpmdW5jdGlvbiBjbG9zZVJlc2V0RGlhbG9nKCl7dmFyIHJvPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXNldE92ZXJsYXknKTtyby5jbGFzc0xpc3QucmVtb3ZlKCdzaG93Jyk7c2V0VGltZW91dChmdW5jdGlvbigpe3JvLnN0eWxlLmRpc3BsYXk9J25vbmUnO30sMTgwKTt9CmZ1bmN0aW9uIGRvUmVzZXQoKXsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG5hbWUnKS52YWx1ZT0nJzsKICBmb3IodmFyIGk9MDtpPFNUUlVDVFVSRS5sZW5ndGg7aSsrKXsKICAgIHZhciBwPVNUUlVDVFVSRVtpXTtwV1twLmlkXT1udWxsOwogICAgdmFyIHBpbnA9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BpbnBfJytwLmlkKTtpZihwaW5wKXBpbnAudmFsdWU9Jyc7CiAgICBwT3BlbltwLmlkXT1mYWxzZTsKICAgIHZhciBzZWM9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlY18nK3AuaWQpLGNoPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwY2hldl8nK3AuaWQpOwogICAgaWYoc2VjKXNlYy5jbGFzc05hbWU9J3Mtc2VjdGlvbic7aWYoY2gpY2guY2xhc3NOYW1lPSdwLWNoZXYnOwogICAgZm9yKHZhciBqPTA7ajxwLnN1YnMubGVuZ3RoO2orKyl7CiAgICAgIHZhciBzPXAuc3Vic1tqXTtzV1tzLmlkXT1udWxsO2luc1tzLmlkXT1bXTtjVHh0W3MuaWRdPScnOwogICAgICB2YXIgc2lucD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lucF8nK3MuaWQpO2lmKHNpbnApc2lucC52YWx1ZT0nJzsKICAgICAgdmFyIGN0eHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N0eHRfJytzLmlkKTtpZihjdHh0KWN0eHQudmFsdWU9Jyc7CiAgICAgIGZvcih2YXIgaz0wO2s8MztrKyspe3ZhciBzZWw9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RfJytzLmlkKydfJytrKTtpZihzZWwpc2VsLnNlbGVjdGVkSW5kZXg9MDt9CiAgICAgIHNPcGVuW3MuaWRdPWZhbHNlOwogICAgICB2YXIgaWE9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lhcmVhXycrcy5pZCksZWQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Vkb3RfJytzLmlkKTsKICAgICAgaWYoaWEpaWEuY2xhc3NOYW1lPSdzLWluc3QtYXJlYSc7aWYoZWQpZWQuY2xhc3NOYW1lPSdzLWV4cGFuZC1kb3QnOwogICAgfQogIH0KICBhbGxFeHBhbmRlZD1mYWxzZTt1cGRhdGVGYWJTdGF0ZSgpO3ZhbGlkYXRlKCk7Y2xvc2VSZXNldERpYWxvZygpOwogIHNob3dUb2FzdCgnXHUyNzA1IEFsbCB3ZWlnaHRzIGNsZWFyZWQgXHUyMDE0IHJlYWR5IHRvIHN0YXJ0IGZyZXNoJyk7Cn0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0blJlc2V0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLG9wZW5SZXNldERpYWxvZyk7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZENhbmNlbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxjbG9zZVJlc2V0RGlhbG9nKTsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JkQ29uZmlybScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxkb1Jlc2V0KTsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc2V0T3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbihlKXtpZihlLnRhcmdldD09PXRoaXMpY2xvc2VSZXNldERpYWxvZygpO30pOwoKLyog4pSA4pSAIFZhbGlkYXRlIOKUgOKUgCAqLwpmdW5jdGlvbiB2YWxpZGF0ZSgpewogIHZhciB0b3RhbD0wLGZpbGxlZD0wLGksdzsKICBmb3IoaT0wO2k8U1RSVUNUVVJFLmxlbmd0aDtpKyspe3c9cFdbU1RSVUNUVVJFW2ldLmlkXTtpZih3IT09bnVsbCYmIWlzTmFOKHcpKXt0b3RhbCs9dztmaWxsZWQrKzt9fQogIHZhciBuUD1TVFJVQ1RVUkUubGVuZ3RoLGFsbEY9KGZpbGxlZD09PW5QKTsKICB2YXIgYmFyPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9nQmFyJykscEVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9nUGN0Jyksc3Q9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2dTdGF0dXMnKTsKICB2YXIgYmI9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JvdEJhcicpLGJwPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib3RQY3QnKTsKICB2YXIgcGN0PU1hdGgubWluKHRvdGFsLDEwMCk7CiAgYmFyLnN0eWxlLndpZHRoPXBjdCsnJSc7YmIuc3R5bGUud2lkdGg9cGN0KyclJzsKICBwRWwudGV4dENvbnRlbnQ9dG90YWwudG9GaXhlZCgxKSsnJSc7YnAudGV4dENvbnRlbnQ9dG90YWwudG9GaXhlZCgxKSsnJSc7CiAgdmFyIG92ZXI9dG90YWw+MTAwLjA0OwogIGJhci5zdHlsZS5iYWNrZ3JvdW5kPW92ZXI/JyNFRjQ0NDQnOicjMTBCOTgxJzsKICBiYi5jbGFzc05hbWU9J2JvdC1iYXInKyhvdmVyPycgYy1vdmVyJzonJyk7CiAgcEVsLmNsYXNzTmFtZT1vdmVyPydjLW92ZXInOicnOwogIGJwLmNsYXNzTmFtZT0nYm90LWFsbG9jLXBjdCcrKG92ZXI/JyBjLW92ZXInOicnKTsKICBpZihvdmVyKXN0LnRleHRDb250ZW50PSdcdTI2YTAgVG90YWwgZXhjZWVkcyAxMDAlICgnK3RvdGFsLnRvRml4ZWQoMSkrJyUpJzsKICBlbHNlIGlmKGFsbEYmJk1hdGguYWJzKHRvdGFsLTEwMCk8MC4wNSlzdC50ZXh0Q29udGVudD0nXHUyNzA1IEFsbCBwYXJlbnQgY2xhc3NlcyBmaWxsZWQgXHUyMDE0IHN1bXMgdG8gMTAwJSc7CiAgZWxzZSBpZihhbGxGKXN0LnRleHRDb250ZW50PSdSZW1haW5pbmc6ICcrKDEwMC10b3RhbCkudG9GaXhlZCgxKSsnJSc7CiAgZWxzZSBzdC50ZXh0Q29udGVudD1maWxsZWQrJyBvZiAnK25QKycgcGFyZW50IGNsYXNzZXMgZmlsbGVkJzsKICBmb3IoaT0wO2k8U1RSVUNUVVJFLmxlbmd0aDtpKyspewogICAgdmFyIHA9U1RSVUNUVVJFW2ldO3c9cFdbcC5pZF07dmFyIHRlPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXJyXycrcC5pZCk7CiAgICBpZih3PT09bnVsbHx8aXNOYU4odykpe2lmKHRlKXRlLmNsYXNzTmFtZT0ncC10YWxseS1lcnInO2NvbnRpbnVlO30KICAgIHZhciBzdWJUPTAsYW55Uz1mYWxzZTsKICAgIGZvcih2YXIgaj0wO2o8cC5zdWJzLmxlbmd0aDtqKyspe3ZhciBzdz1zV1twLnN1YnNbal0uaWRdO2lmKHN3IT09bnVsbCYmc3chPT11bmRlZmluZWQmJiFpc05hTihzdykpe3N1YlQrPXN3O2FueVM9dHJ1ZTt9fQogICAgaWYodGUpdGUuY2xhc3NOYW1lPSdwLXRhbGx5LWVycicrKGFueVMmJk1hdGguYWJzKHN1YlQtdyk+PTAuMDY/JyBzaG93JzonJyk7CiAgfQogIHZhciB2PWlzVmFsaWQoKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuU3VtbWFyeScpLmNsYXNzTmFtZT0nYnRuLXN1bW1hcnknKyh2PycnOicgaW5hY3RpdmUnKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuRXhwb3J0JykuY2xhc3NOYW1lPSdidG4tcGRmJysodj8nJzonIGluYWN0aXZlJyk7Cn0KZnVuY3Rpb24gY29sbGVjdEVycm9ycygpewogIHZhciBlcnJzPVtdLHRvdGFsPTAsbWlzc2luZz1bXSxpLGoscCx3LHN3LHN1YlQsYW55UzsKICBmb3IoaT0wO2k8U1RSVUNUVVJFLmxlbmd0aDtpKyspe3c9cFdbU1RSVUNUVVJFW2ldLmlkXTtpZih3PT09bnVsbHx8aXNOYU4odykpbWlzc2luZy5wdXNoKFNUUlVDVFVSRVtpXS5uYW1lKTtlbHNlIHRvdGFsKz13O30KICBpZihtaXNzaW5nLmxlbmd0aCllcnJzLnB1c2goJ01pc3Npbmcgd2VpZ2h0IGZvcjpcbicrbWlzc2luZy5qb2luKCcsICcpKTsKICBlbHNlIGlmKE1hdGguYWJzKHRvdGFsLTEwMCk+PTAuMDUpZXJycy5wdXNoKCdXZWlnaHRzIHN1bSB0byAnK3RvdGFsLnRvRml4ZWQoMSkrJyUgXHUyMDE0IG11c3QgZXF1YWwgMTAwJScpOwogIGZvcihpPTA7aTxTVFJVQ1RVUkUubGVuZ3RoO2krKyl7CiAgICBwPVNUUlVDVFVSRVtpXTt3PXBXW3AuaWRdO2lmKHc9PT1udWxsfHxpc05hTih3KSljb250aW51ZTsKICAgIHN1YlQ9MDthbnlTPWZhbHNlOwogICAgZm9yKGo9MDtqPHAuc3Vicy5sZW5ndGg7aisrKXtzdz1zV1twLnN1YnNbal0uaWRdO2lmKHN3IT09bnVsbCYmIWlzTmFOKHN3KSl7c3ViVCs9c3c7YW55Uz10cnVlO319CiAgICBpZihhbnlTJiZNYXRoLmFicyhzdWJULXcpPj0wLjA2KWVycnMucHVzaChwLm5hbWUrJzogc3ViLXdlaWdodHMgKCcrc3ViVC50b0ZpeGVkKDEpKyclKSBcdTIyNjAgcGFyZW50ICgnK3cudG9GaXhlZCgxKSsnJSknKTsKICB9CiAgcmV0dXJuIGVycnM7Cn0KZnVuY3Rpb24gaXNWYWxpZCgpe3JldHVybiBjb2xsZWN0RXJyb3JzKCkubGVuZ3RoPT09MDt9CmZ1bmN0aW9uIHNob3dUb2FzdChtc2cpewogIHZhciB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2FzdCcpO3QudGV4dENvbnRlbnQ9bXNnO3QuY2xhc3NMaXN0LmFkZCgnc2hvdycpOwogIGlmKHRvYXN0VGltZXIpY2xlYXJUaW1lb3V0KHRvYXN0VGltZXIpOwogIHRvYXN0VGltZXI9c2V0VGltZW91dChmdW5jdGlvbigpe3QuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO30sNDAwMCk7Cn0KZnVuY3Rpb24gZXNjKHMpe3JldHVybiBTdHJpbmcocykucmVwbGFjZSgvJi9nLCcmYW1wOycpLnJlcGxhY2UoLzwvZywnJmx0OycpLnJlcGxhY2UoLz4vZywnJmd0OycpLnJlcGxhY2UoLyIvZywnJnF1b3Q7Jyk7fQoKLyog4pSA4pSAIFN1bW1hcnkgbW9kYWwg4pSA4pSAICovCmZ1bmN0aW9uIGJ1aWxkU3VtbWFyeUhUTUwobmFtZSxkYXRlU3RyKXsKICB2YXIgZ3JhbmQ9MCxodG1sPScnLGksaixwLHMscHcsc3csZnMsc2gsaW5zdHMsY3QsZGV0YWlsOwogIGh0bWw9JzxkaXYgY2xhc3M9Im0tbWV0YSI+UG9ydGZvbGlvOiA8Yj4nK2VzYyhuYW1lKSsnPC9iPiAmbmJzcDsmbWlkZG90OyZuYnNwOyAnK2RhdGVTdHIrJzwvZGl2Pic7CiAgZm9yKGk9MDtpPFNUUlVDVFVSRS5sZW5ndGg7aSsrKXsKICAgIHA9U1RSVUNUVVJFW2ldO3B3PXBXW3AuaWRdfHwwO2dyYW5kKz1wdzsKICAgIHZhciBhPUFDQ0VOVFtpJUFDQ0VOVC5sZW5ndGhdOwogICAgZnM9W107CiAgICBmb3Ioaj0wO2o8cC5zdWJzLmxlbmd0aDtqKyspe3N3PXNXW3Auc3Vic1tqXS5pZF07aWYoc3chPT1udWxsJiZzdyE9PXVuZGVmaW5lZCYmIWlzTmFOKHN3KSlmcy5wdXNoKHAuc3Vic1tqXSk7fQogICAgc2g9Jyc7CiAgICBpZighZnMubGVuZ3RoKXtzaD0nPGRpdiBjbGFzcz0ibS1lbXB0eSI+Tm8gc3ViLWFzc2V0IHdlaWdodHMgZW50ZXJlZDwvZGl2Pic7fQogICAgZWxzZXsKICAgICAgZm9yKGo9MDtqPGZzLmxlbmd0aDtqKyspewogICAgICAgIHM9ZnNbal07c3c9c1dbcy5pZF07aW5zdHM9aW5zW3MuaWRdfHxbXTtjdD1jVHh0W3MuaWRdfHwnJztkZXRhaWw9Jyc7CiAgICAgICAgaWYocy5jdXN0b20mJmN0KWRldGFpbD0nPGRpdiBjbGFzcz0ibS1zaW5zdCI+Jytlc2MoY3QpKyc8L2Rpdj4nOwogICAgICAgIGVsc2UgaWYoIXMuY3VzdG9tJiZpbnN0cy5sZW5ndGgpZGV0YWlsPSc8ZGl2IGNsYXNzPSJtLXNpbnN0Ij4nK2VzYyhpbnN0cy5qb2luKCcgXHUwMGI3ICcpKSsnPC9kaXY+JzsKICAgICAgICBzaCs9JzxkaXYgY2xhc3M9Im0tc3JvdyI+PGRpdj48ZGl2IGNsYXNzPSJtLXNuYW1lIj4nK2VzYyhzLm5hbWUpKyc8L2Rpdj4nK2RldGFpbCsnPC9kaXY+PGRpdiBjbGFzcz0ibS1zd3QiPicrc3cudG9GaXhlZCgxKSsnJTwvZGl2PjwvZGl2Pic7CiAgICAgIH0KICAgIH0KICAgIGh0bWwrPSc8ZGl2IGNsYXNzPSJtLXBibG9jayI+PGRpdiBjbGFzcz0ibS1waGRyIiBzdHlsZT0iYmFja2dyb3VuZDonK2EuYmFyKyciPjxzcGFuPicrZXNjKHAubmFtZSkrJzwvc3Bhbj48c3Bhbj4nK3B3LnRvRml4ZWQoMSkrJyU8L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz0ibS1zdWJzIj4nK3NoKyc8L2Rpdj48L2Rpdj4nOwogIH0KICBodG1sKz0nPGRpdiBjbGFzcz0ibS10b3RhbCI+PHNwYW4+VG90YWwgQWxsb2NhdGlvbjwvc3Bhbj48c3Bhbj4nK2dyYW5kLnRvRml4ZWQoMSkrJyU8L3NwYW4+PC9kaXY+JzsKICByZXR1cm4gaHRtbDsKfQpmdW5jdGlvbiBvcGVuU3VtbWFyeSgpewogIHZhciBlcnJzPWNvbGxlY3RFcnJvcnMoKTtpZihlcnJzLmxlbmd0aCl7c2hvd1RvYXN0KGVycnMuam9pbignXG4nKSk7cmV0dXJuO30KICB2YXIgbmFtZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG5hbWUnKS52YWx1ZXx8J1VubmFtZWQgUG9ydGZvbGlvJzsKICB2YXIgZGF0ZVN0cj1uZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tSU4nLHtkYXk6JzItZGlnaXQnLG1vbnRoOidzaG9ydCcseWVhcjonbnVtZXJpYyd9KTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxCb2R5JykuaW5uZXJIVE1MPWJ1aWxkU3VtbWFyeUhUTUwobmFtZSxkYXRlU3RyKTsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpLnN0eWxlLmRpc3BsYXk9J2ZsZXgnOwogIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpe2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5JykuY2xhc3NMaXN0LmFkZCgnc2hvdycpO30pOwp9CmZ1bmN0aW9uIGNsb3NlU3VtbWFyeSgpewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5JykuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpOwogIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpLnN0eWxlLmRpc3BsYXk9J25vbmUnO30sMjIwKTsKfQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuU3VtbWFyeScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxvcGVuU3VtbWFyeSk7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5DbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxjbG9zZVN1bW1hcnkpOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbihlKXtpZihlLnRhcmdldD09PXRoaXMpY2xvc2VTdW1tYXJ5KCk7fSk7CgovKiDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAKICAgUERGIEdFTkVSQVRJT04gIOKAlCAganNQREYgKyBubyBleHRlcm5hbCByYXN0ZXJpc2VyCiAgIERyYXdzIGV2ZXJ5dGhpbmcgbmF0aXZlbHkgb24gYSBqc1BERiBjYW52YXM6CiAgICAg4oCiIGJyYW5kZWQgaGVhZGVyIGJhcgogICAgIOKAoiBkb251dCBjaGFydCAoZHJhd24gd2l0aCBqc1BERiBhcmMgY2FsbHMpCiAgICAg4oCiIGFsbG9jYXRpb24gdGFibGUgd2l0aCBjb2xvdXJlZCByb3cgaGVhZGVycwogICDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZAgKi8KdmFyIF9qc1BERkxvYWRlZD1mYWxzZTsKZnVuY3Rpb24gbG9hZEpzUERGKGNiKXsKICBpZih3aW5kb3cuanNwZGYmJndpbmRvdy5qc3BkZi5qc1BERil7Y2IoKTtyZXR1cm47fQogIHZhciBzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOwogIHMuc3JjPSdodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9qc3BkZi8yLjUuMS9qc3BkZi51bWQubWluLmpzJzsKICBzLm9ubG9hZD1mdW5jdGlvbigpe19qc1BERkxvYWRlZD10cnVlO2NiKCk7fTsKICBzLm9uZXJyb3I9ZnVuY3Rpb24oKXtzaG93VG9hc3QoJ1x1MjZhMCBDb3VsZCBub3QgbG9hZCBQREYgbGlicmFyeS4gQ2hlY2sgaW50ZXJuZXQgY29ubmVjdGlvbi4nKTt9OwogIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQocyk7Cn0KCmZ1bmN0aW9uIGRyYXdEb251dChkb2MsY3gsY3ksUixyLHNsaWNlcyl7CiAgLyogc2xpY2VzOiBbe3BjdCwgY29sb3J9XSAqLwogIHZhciB0b3RhbD0wO2Zvcih2YXIgaT0wO2k8c2xpY2VzLmxlbmd0aDtpKyspdG90YWwrPXNsaWNlc1tpXS5wY3Q7CiAgaWYodG90YWw8PTApcmV0dXJuOwogIHZhciBhbmdsZT0tTWF0aC5QSS8yOyAvKiBzdGFydCBhdCB0b3AgKi8KICBmb3IodmFyIGk9MDtpPHNsaWNlcy5sZW5ndGg7aSsrKXsKICAgIHZhciBzd2VlcD0oc2xpY2VzW2ldLnBjdC8xMDApKjIqTWF0aC5QSTsKICAgIGlmKHN3ZWVwPDAuMDAxKWNvbnRpbnVlOwogICAgdmFyIGExPWFuZ2xlLGEyPWFuZ2xlK3N3ZWVwOwogICAgLyogQnVpbGQgd2VkZ2UgcGF0aCBtYW51YWxseSAqLwogICAgdmFyIHB0cz1bXTsKICAgIHZhciBzdGVwcz1NYXRoLm1heCgyLE1hdGgucm91bmQoc3dlZXAvKE1hdGguUEkvMTgpKSk7CiAgICAvKiBvdXRlciBhcmMgKi8KICAgIGZvcih2YXIgaz0wO2s8PXN0ZXBzO2srKyl7dmFyIGE9YTErKGEyLWExKSooay9zdGVwcyk7cHRzLnB1c2goW2N4K1IqTWF0aC5jb3MoYSksY3krUipNYXRoLnNpbihhKV0pO30KICAgIC8qIGlubmVyIGFyYyByZXZlcnNlZCAqLwogICAgZm9yKHZhciBrPXN0ZXBzO2s+PTA7ay0tKXt2YXIgYT1hMSsoYTItYTEpKihrL3N0ZXBzKTtwdHMucHVzaChbY3grcipNYXRoLmNvcyhhKSxjeStyKk1hdGguc2luKGEpXSk7fQogICAgZG9jLnNldEZpbGxDb2xvcihzbGljZXNbaV0uY29sb3IpOwogICAgZG9jLm1vdmVUbyhwdHNbMF1bMF0scHRzWzBdWzFdKTsKICAgIC8qIHVzZSBsaW5lcyDigJQganNQREYgMi54IHN1cHBvcnRzIGxpbmVzKCkgKi8KICAgIHZhciBscHM9W107Zm9yKHZhciBtPTE7bTxwdHMubGVuZ3RoO20rKylscHMucHVzaChbcHRzW21dWzBdLXB0c1ttLTFdWzBdLHB0c1ttXVsxXS1wdHNbbS0xXVsxXV0pOwogICAgZG9jLmxpbmVzKGxwcyxwdHNbMF1bMF0scHRzWzBdWzFdLFsxLDFdLG51bGwsdHJ1ZSk7IC8qIG51bGw9bm8gc3Ryb2tlLCB0cnVlPWNsb3NlZCAqLwogICAgZG9jLmZpbGwoKTsKICAgIGFuZ2xlPWEyOwogIH0KICAvKiBDZW50cmUgaG9sZTogd2hpdGUgY2lyY2xlICovCiAgZG9jLnNldEZpbGxDb2xvcignI0ZGRkZGRicpOwogIGRvYy5jaXJjbGUoY3gsY3ksci0wLjUsJ0YnKTsKfQoKZnVuY3Rpb24gZ2VuZXJhdGVQREYoKXsKICB2YXIgZXJycz1jb2xsZWN0RXJyb3JzKCk7aWYoZXJycy5sZW5ndGgpe3Nob3dUb2FzdChlcnJzLmpvaW4oJ1xuJykpO3JldHVybjt9CiAgdmFyIGJ0bj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuRXhwb3J0Jyk7CiAgYnRuLnRleHRDb250ZW50PSdcdTIzRjMgQnVpbGRpbmdcdTIwMjYnO2J0bi5jbGFzc0xpc3QuYWRkKCdsb2FkaW5nJyk7YnRuLmRpc2FibGVkPXRydWU7CgogIGxvYWRKc1BERihmdW5jdGlvbigpewogICAgdHJ5ewogICAgICB2YXIganNQREY9d2luZG93LmpzcGRmLmpzUERGOwogICAgICB2YXIgZG9jPW5ldyBqc1BERih7b3JpZW50YXRpb246J3BvcnRyYWl0Jyx1bml0OidtbScsZm9ybWF0OidhNCd9KTsKICAgICAgdmFyIHB3PTIxMCxwaD0yOTc7IC8qIEE0ICovCiAgICAgIHZhciBsbT0xNCxybT0xNCx0bT0wLGN3PXB3LWxtLXJtOyAvKiBtYXJnaW5zICovCgogICAgICB2YXIgbmFtZT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG5hbWUnKS52YWx1ZXx8J1VubmFtZWQgUG9ydGZvbGlvJzsKICAgICAgdmFyIGRhdGVTdHI9bmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUlOJyx7ZGF5OicyLWRpZ2l0Jyxtb250aDonc2hvcnQnLHllYXI6J251bWVyaWMnfSk7CgogICAgICAvKiDilIDilIAgQ29sbGVjdCBkYXRhIOKUgOKUgCAqLwogICAgICB2YXIgcm93cz1bXTsKICAgICAgZm9yKHZhciBpPTA7aTxTVFJVQ1RVUkUubGVuZ3RoO2krKyl7CiAgICAgICAgdmFyIHA9U1RSVUNUVVJFW2ldLHB3Xz1wV1twLmlkXXx8MDsKICAgICAgICBpZihwd188PTApY29udGludWU7CiAgICAgICAgdmFyIHN1YnM9W107CiAgICAgICAgZm9yKHZhciBqPTA7ajxwLnN1YnMubGVuZ3RoO2orKyl7CiAgICAgICAgICB2YXIgcz1wLnN1YnNbal0sc3c9c1dbcy5pZF07CiAgICAgICAgICBpZihzdz09PW51bGx8fHN3PT09dW5kZWZpbmVkfHxpc05hTihzdyl8fHN3PD0wKWNvbnRpbnVlOwogICAgICAgICAgdmFyIGluc3RzPWluc1tzLmlkXXx8W10sY3Q9Y1R4dFtzLmlkXXx8Jyc7CiAgICAgICAgICBzdWJzLnB1c2goe25hbWU6cy5uYW1lLHBjdDpzdyxsYWJlbDpzLmN1c3RvbT8oY3R8fCfigJQnKTooaW5zdHMubGVuZ3RoP2luc3RzWzBdOicnKX0pOwogICAgICAgIH0KICAgICAgICByb3dzLnB1c2goe25hbWU6cC5uYW1lLHBjdDpwd18sY29sb3I6QUNDRU5UW2klQUNDRU5ULmxlbmd0aF0uYmFyLHN1YnM6c3Vic30pOwogICAgICB9CgogICAgICAvKiDilIDilIAgMS4gSGVhZGVyIGJhciDilIDilIAgKi8KICAgICAgZG9jLnNldEZpbGxDb2xvcignIzBGMTcyQScpOwogICAgICBkb2MucmVjdCgwLDAsMjEwLDIyLCdGJyk7CiAgICAgIGRvYy5zZXRUZXh0Q29sb3IoJyNGRkZGRkYnKTsKICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ2JvbGQnKTsKICAgICAgZG9jLnNldEZvbnRTaXplKDEzKTsKICAgICAgZG9jLnRleHQoJ1BvcnRmb2xpbyBDb25zdHJ1Y3RvcicsbG0sOSk7CiAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdub3JtYWwnKTsKICAgICAgZG9jLnNldEZvbnRTaXplKDgpOwogICAgICBkb2MudGV4dCgnQXNzZXQgQWxsb2NhdGlvbiBSZXBvcnQnLGxtLDE0LjUpOwogICAgICBkb2Muc2V0Rm9udCgnaGVsdmV0aWNhJywnYm9sZCcpOwogICAgICBkb2Muc2V0Rm9udFNpemUoOSk7CiAgICAgIGRvYy50ZXh0KG5hbWUsbG0sMjApOwogICAgICAvKiBkYXRlIHJpZ2h0LWFsaWduZWQgKi8KICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ25vcm1hbCcpOwogICAgICBkb2Muc2V0Rm9udFNpemUoOCk7CiAgICAgIGRvYy5zZXRUZXh0Q29sb3IoJyM5NEEzQjgnKTsKICAgICAgdmFyIGR3PWRvYy5nZXRUZXh0V2lkdGgoZGF0ZVN0cik7CiAgICAgIGRvYy50ZXh0KGRhdGVTdHIscHctcm0tZHcsMjApOwoKICAgICAgdmFyIHk9MzA7IC8qIGN1cnNvciAqLwoKICAgICAgLyog4pSA4pSAIDIuIERvbnV0IGNoYXJ0IOKUgOKUgCAqLwogICAgICB2YXIgY3g9bG0rMzAsY3k9eSsyOCxSPTI2LHI9MTQ7CiAgICAgIC8qIGJ1aWxkIHNsaWNlcyAqLwogICAgICB2YXIgc2xpY2VzPVtdO2Zvcih2YXIgaT0wO2k8cm93cy5sZW5ndGg7aSsrKXNsaWNlcy5wdXNoKHtwY3Q6cm93c1tpXS5wY3QsY29sb3I6cm93c1tpXS5jb2xvcn0pOwogICAgICBkcmF3RG9udXQoZG9jLGN4LGN5LFIscixzbGljZXMpOwogICAgICAvKiBjZW50cmUgbGFiZWwgKi8KICAgICAgZG9jLnNldFRleHRDb2xvcignIzBGMTcyQScpOwogICAgICBkb2Muc2V0Rm9udCgnaGVsdmV0aWNhJywnYm9sZCcpOwogICAgICBkb2Muc2V0Rm9udFNpemUoOSk7CiAgICAgIHZhciBsYmw9JzEwMCUnO3ZhciBsdz1kb2MuZ2V0VGV4dFdpZHRoKGxibCk7CiAgICAgIGRvYy50ZXh0KGxibCxjeC1sdy8yLGN5KzEuNSk7CiAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdub3JtYWwnKTsKICAgICAgZG9jLnNldEZvbnRTaXplKDYpOwogICAgICBkb2Muc2V0VGV4dENvbG9yKCcjNjQ3NDhCJyk7CiAgICAgIHZhciBhbD0nYWxsb2NhdGVkJzt2YXIgYXc9ZG9jLmdldFRleHRXaWR0aChhbCk7CiAgICAgIGRvYy50ZXh0KGFsLGN4LWF3LzIsY3krNS41KTsKCiAgICAgIC8qIExlZ2VuZCB0byB0aGUgcmlnaHQgb2YgZG9udXQgKi8KICAgICAgdmFyIGx4PWN4K1IrOCxseT15KzQ7CiAgICAgIGZvcih2YXIgaT0wO2k8cm93cy5sZW5ndGg7aSsrKXsKICAgICAgICBkb2Muc2V0RmlsbENvbG9yKHJvd3NbaV0uY29sb3IpOwogICAgICAgIGRvYy5yb3VuZGVkUmVjdChseCxseStpKjcsMywzLDAuNSwwLjUsJ0YnKTsKICAgICAgICBkb2Muc2V0VGV4dENvbG9yKCcjMEYxNzJBJyk7CiAgICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ2JvbGQnKTsKICAgICAgICBkb2Muc2V0Rm9udFNpemUoNy41KTsKICAgICAgICBkb2MudGV4dChyb3dzW2ldLm5hbWUsbHgrNSxseStpKjcrMi40KTsKICAgICAgICBkb2Muc2V0Rm9udCgnaGVsdmV0aWNhJywnbm9ybWFsJyk7CiAgICAgICAgZG9jLnNldFRleHRDb2xvcignIzY0NzQ4QicpOwogICAgICAgIHZhciBwdzI9ZG9jLmdldFRleHRXaWR0aChyb3dzW2ldLnBjdC50b0ZpeGVkKDEpKyclJyk7CiAgICAgICAgZG9jLnRleHQocm93c1tpXS5wY3QudG9GaXhlZCgxKSsnJScsbG0rY3ctcHcyLGx5K2kqNysyLjQpOwogICAgICB9CgogICAgICB5PWN5K1IrMTA7IC8qIGJlbG93IGNoYXJ0ICovCgogICAgICAvKiDilIDilIAgMy4gRGl2aWRlciDilIDilIAgKi8KICAgICAgZG9jLnNldERyYXdDb2xvcignI0UyRThGMCcpOwogICAgICBkb2Muc2V0TGluZVdpZHRoKDAuMyk7CiAgICAgIGRvYy5saW5lKGxtLHksbG0rY3cseSk7CiAgICAgIHkrPTY7CgogICAgICAvKiDilIDilIAgNC4gQWxsb2NhdGlvbiB0YWJsZSDilIDilIAgKi8KICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ2JvbGQnKTsKICAgICAgZG9jLnNldEZvbnRTaXplKDkpOwogICAgICBkb2Muc2V0VGV4dENvbG9yKCcjMEYxNzJBJyk7CiAgICAgIGRvYy50ZXh0KCdEZXRhaWxlZCBBbGxvY2F0aW9uJyxsbSx5KTsKICAgICAgeSs9NTsKCiAgICAgIGZvcih2YXIgaT0wO2k8cm93cy5sZW5ndGg7aSsrKXsKICAgICAgICB2YXIgcm93PXJvd3NbaV07CiAgICAgICAgLyogUGFyZW50IHJvdyDigJQgY29sb3VyZWQgYmFja2dyb3VuZCAqLwogICAgICAgIGRvYy5zZXRGaWxsQ29sb3Iocm93LmNvbG9yKTsKICAgICAgICBkb2MucmVjdChsbSx5LGN3LDcsJ0YnKTsKICAgICAgICBkb2Muc2V0VGV4dENvbG9yKCcjRkZGRkZGJyk7CiAgICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ2JvbGQnKTsKICAgICAgICBkb2Muc2V0Rm9udFNpemUoOC41KTsKICAgICAgICBkb2MudGV4dChyb3cubmFtZSxsbSszLHkrNC44KTsKICAgICAgICB2YXIgcHA9cm93LnBjdC50b0ZpeGVkKDEpKyclJzsKICAgICAgICB2YXIgcHB3PWRvYy5nZXRUZXh0V2lkdGgocHApOwogICAgICAgIGRvYy50ZXh0KHBwLGxtK2N3LXBwdy0zLHkrNC44KTsKICAgICAgICB5Kz03OwoKICAgICAgICAvKiBTdWIgcm93cyAqLwogICAgICAgIGZvcih2YXIgaj0wO2o8cm93LnN1YnMubGVuZ3RoO2orKyl7CiAgICAgICAgICB2YXIgc3ViPXJvdy5zdWJzW2pdOwogICAgICAgICAgdmFyIGJnPWolMj09PTA/JyNGOEZBRkMnOicjRkZGRkZGJzsKICAgICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoYmcpOwogICAgICAgICAgZG9jLnJlY3QobG0seSxjdyw2LjUsJ0YnKTsKICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoJyMxRTI5M0InKTsKICAgICAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdib2xkJyk7CiAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoNy41KTsKICAgICAgICAgIGRvYy50ZXh0KHN1Yi5uYW1lLGxtKzYseSs0LjMpOwogICAgICAgICAgaWYoc3ViLmxhYmVsKXsKICAgICAgICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ25vcm1hbCcpOwogICAgICAgICAgICBkb2Muc2V0VGV4dENvbG9yKCcjNjQ3NDhCJyk7CiAgICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSg2LjUpOwogICAgICAgICAgICBkb2MudGV4dChzdWIubGFiZWwsbG0rNix5KzQuMys0KTsKICAgICAgICAgICAgeSs9NDsgLyogZXh0cmEgaGVpZ2h0IGZvciBpbnN0cnVtZW50IGxpbmUgKi8KICAgICAgICAgIH0KICAgICAgICAgIHZhciBzcD1zdWIucGN0LnRvRml4ZWQoMSkrJyUnOwogICAgICAgICAgdmFyIHNwdz1kb2MuZ2V0VGV4dFdpZHRoKHNwKTsKICAgICAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdib2xkJyk7CiAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoNy41KTsKICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoJyMwRjE3MkEnKTsKICAgICAgICAgIGRvYy50ZXh0KHNwLGxtK2N3LXNwdy0zLHkrNC4zKTsKICAgICAgICAgIHkrPTYuNTsKICAgICAgICB9CiAgICAgICAgaWYoIXJvdy5zdWJzLmxlbmd0aCl7CiAgICAgICAgICBkb2Muc2V0RmlsbENvbG9yKCcjRjhGQUZDJyk7CiAgICAgICAgICBkb2MucmVjdChsbSx5LGN3LDYsJ0YnKTsKICAgICAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdub3JtYWwnKTsKICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSg3KTsKICAgICAgICAgIGRvYy5zZXRUZXh0Q29sb3IoJyM5NEEzQjgnKTsKICAgICAgICAgIGRvYy50ZXh0KCdObyBzdWItYXNzZXQgYnJlYWtkb3duIGVudGVyZWQnLGxtKzYseSs0KTsKICAgICAgICAgIHkrPTY7CiAgICAgICAgfQogICAgICAgIHkrPTI7IC8qIGdhcCBiZXR3ZWVuIHBhcmVudCBibG9ja3MgKi8KCiAgICAgICAgLyogUGFnZSBicmVhayBzYWZldHkgKi8KICAgICAgICBpZih5PnBoLTIwKXtkb2MuYWRkUGFnZSgpO3k9MTQ7fQogICAgICB9CgogICAgICAvKiDilIDilIAgNS4gVG90YWwgcm93IOKUgOKUgCAqLwogICAgICB5Kz0yOwogICAgICBkb2Muc2V0RmlsbENvbG9yKCcjRUNGREY1Jyk7CiAgICAgIGRvYy5yZWN0KGxtLHksY3csOCwnRicpOwogICAgICBkb2Muc2V0RHJhd0NvbG9yKCcjNkVFN0I3Jyk7CiAgICAgIGRvYy5zZXRMaW5lV2lkdGgoMC40KTsKICAgICAgZG9jLnJlY3QobG0seSxjdyw4LCdTJyk7CiAgICAgIGRvYy5zZXRGb250KCdoZWx2ZXRpY2EnLCdib2xkJyk7CiAgICAgIGRvYy5zZXRGb250U2l6ZSg5KTsKICAgICAgZG9jLnNldFRleHRDb2xvcignIzA2NUY0NicpOwogICAgICBkb2MudGV4dCgnVG90YWwgQWxsb2NhdGlvbicsbG0rNCx5KzUuNSk7CiAgICAgIHZhciB0b3Q9JzEwMC4wJSc7dmFyIHR3PWRvYy5nZXRUZXh0V2lkdGgodG90KTsKICAgICAgZG9jLnRleHQodG90LGxtK2N3LXR3LTQseSs1LjUpOwoKICAgICAgLyog4pSA4pSAIDYuIEZvb3RlciDilIDilIAgKi8KICAgICAgZG9jLnNldEZvbnQoJ2hlbHZldGljYScsJ25vcm1hbCcpOwogICAgICBkb2Muc2V0Rm9udFNpemUoNi41KTsKICAgICAgZG9jLnNldFRleHRDb2xvcignIzk0QTNCOCcpOwogICAgICB2YXIgZm9vdD0nR2VuZXJhdGVkIGJ5IFBvcnRmb2xpbyBDb25zdHJ1Y3RvciBcdTAwYjcgJytkYXRlU3RyKycgXHUwMGI3IEZvciBpbmZvcm1hdGlvbmFsIHB1cnBvc2VzIG9ubHknOwogICAgICB2YXIgZnc9ZG9jLmdldFRleHRXaWR0aChmb290KTsKICAgICAgZG9jLnRleHQoZm9vdCwocHctZncpLzIscGgtNik7CgogICAgICAvKiDilIDilIAgU2F2ZSDilIDilIAgKi8KICAgICAgdmFyIGZuYW1lPShuYW1lLnJlcGxhY2UoL1teYS16MC05XS9naSwnXycpfHwncG9ydGZvbGlvJykrJ19hbGxvY2F0aW9uLnBkZic7CiAgICAgIGRvYy5zYXZlKGZuYW1lKTsKICAgICAgc2hvd1RvYXN0KCdcdTI3MDUgUERGIHNhdmVkIGFzICcrZm5hbWUpOwogICAgfWNhdGNoKGVycil7CiAgICAgIHNob3dUb2FzdCgnXHUyNmEwIFBERiBlcnJvcjogJytlcnIubWVzc2FnZSk7CiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgIH0KICAgIGJ0bi5pbm5lckhUTUw9JyYjeDJCMDc7IFBERic7YnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRpbmcnKTtidG4uZGlzYWJsZWQ9ZmFsc2U7CiAgfSk7Cn0KCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5FeHBvcnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZ2VuZXJhdGVQREYpOwoKYnVpbGRVSSgpO3ZhbGlkYXRlKCk7dXBkYXRlRmFiU3RhdGUoKTsKPC9zY3JpcHQ+CjwvYm9keT48L2h0bWw+";

var parsedStructure=null,parsedFunds=null;
function setStep(n){for(var i=1;i<=3;i++){var e=document.getElementById('step'+i);if(e)e.className='step'+(i<n?' done':i===n?' active':'');}}
function parseCSVLine(line){var res=[],cur='',inQ=false;for(var i=0;i<line.length;i++){var c=line[i];if(c==='"'){if(inQ&&line[i+1]==='"'){cur+='"';i++;}else inQ=!inQ;}else if(c===','&&!inQ){res.push(cur);cur='';}else cur+=c;}res.push(cur);return res;}
function parseCSV(text){
  var lines=text.split(/\r?\n/);if(!lines.length)return{error:'Empty file'};
  var hdr=lines[0].toLowerCase().split(',');
  var ci={parent_id:hdr.indexOf('parent_id'),parent_name:hdr.indexOf('parent_name'),sub_id:hdr.indexOf('sub_id'),sub_name:hdr.indexOf('sub_name'),fund_type:hdr.indexOf('fund_type'),fund_name:hdr.indexOf('fund_name')};
  for(var k in ci){if(ci[k]===-1)return{error:'Missing required column: '+k};}
  var pOrder=[],pMap={},fMap={};
  for(var i=1;i<lines.length;i++){
    var ln=lines[i].trim();if(!ln)continue;
    var c=parseCSVLine(ln);
    var pid=c[ci.parent_id]?c[ci.parent_id].trim():'';var pnm=c[ci.parent_name]?c[ci.parent_name].trim():'';
    var sid=c[ci.sub_id]?c[ci.sub_id].trim():'';var snm=c[ci.sub_name]?c[ci.sub_name].trim():'';
    var ftype=c[ci.fund_type]?c[ci.fund_type].trim().toLowerCase():'';var fname=c[ci.fund_name]?c[ci.fund_name].trim():'';
    if(!pid||!sid)continue;
    if(!pMap[pid]){pMap[pid]={id:pid,name:pnm,custom:false,subs:[],subMap:{}};pOrder.push(pid);}
    var par=pMap[pid];
    if(!par.subMap[sid]){var isCust=(ftype==='custom');par.subMap[sid]={id:sid,name:snm,fk:sid,custom:isCust};par.subs.push(par.subMap[sid]);if(isCust)par.custom=true;}
    if(ftype!=='custom'&&fname){if(!fMap[sid])fMap[sid]={recommended:[],all:[]};if(ftype==='recommended')fMap[sid].recommended.push(fname);else fMap[sid].all.push(fname);}
  }
  if(!pOrder.length)return{error:'No valid rows found.'};
  var out=[];for(var j=0;j<pOrder.length;j++){var p=pMap[pOrder[j]];out.push({id:p.id,name:p.name,custom:p.custom,subs:p.subs});}
  return{structure:out,funds:{sub_assets:fMap}};
}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function showMsg(id,txt){var e=document.getElementById(id);e.textContent=txt;e.classList.add('show');}
function hideMsg(id){document.getElementById(id).classList.remove('show');}
function handleFile(file){
  if(!file)return;
  if(!file.name.toLowerCase().endsWith('.csv')){showMsg('msgErr','Please select a .csv file.');return;}
  hideMsg('msgErr');
  var reader=new FileReader();
  reader.onload=function(ev){
    var result=parseCSV(ev.target.result);
    if(result.error){showMsg('msgErr','CSV Error: '+result.error);return;}
    parsedStructure=result.structure;parsedFunds=result.funds;
    document.getElementById('dropZone').classList.add('loaded');
    document.getElementById('dzFname').textContent='\u2705 '+file.name+' loaded';
    document.getElementById('btnPreview').disabled=false;setStep(2);
  };
  reader.onerror=function(){showMsg('msgErr','Could not read file.');};
  reader.readAsText(file);
}
function renderPreview(structure,funds){
  var ts=0,tf=0,html='';
  for(var i=0;i<structure.length;i++){
    var p=structure[i];ts+=p.subs.length;var sh='';
    for(var j=0;j<p.subs.length;j++){
      var s=p.subs[j];var fd=(funds.sub_assets&&funds.sub_assets[s.fk])?funds.sub_assets[s.fk]:{recommended:[],all:[]};
      var rec=fd.recommended?fd.recommended.length:0,al=fd.all?fd.all.length:0;tf+=rec+al;
      var tag=s.custom?'<span class="prev-tag tag-custom">custom</span>':((rec+al)===0?'<span class="prev-tag tag-nofunds">no funds</span>':'');
      var cnt=s.custom?'notes field':(rec+al>0?rec+' recommended, '+al+' other':'none');
      sh+='<div class="prev-srow"><span class="prev-sname">'+esc(s.name)+tag+'</span><span class="prev-fcount">'+cnt+'</span></div>';
    }
    html+='<div class="prev-parent"><div class="prev-phdr"><span>'+esc(p.name)+'</span><span>'+p.subs.length+' sub-asset'+(p.subs.length!==1?'s':'')+'</span></div>'+sh+'</div>';
  }
  document.getElementById('prevMeta').innerHTML='<span>'+structure.length+'</span> parent classes &nbsp;\u00B7&nbsp; <span>'+ts+'</span> sub-assets &nbsp;\u00B7&nbsp; <span>'+tf+'</span> fund entries';
  document.getElementById('prevContent').innerHTML=html;
  document.getElementById('preview').style.display='block';
  document.getElementById('placeholder').style.display='none';
}
function structureToJS(structure){
  var lines=['['];
  for(var i=0;i<structure.length;i++){
    var p=structure[i],sa=[];
    for(var j=0;j<p.subs.length;j++){var s=p.subs[j];sa.push('    {id:'+JSON.stringify(s.id)+',name:'+JSON.stringify(s.name)+',fk:'+JSON.stringify(s.fk)+',custom:'+(s.custom?'true':'false')+'}');}
    lines.push('  {id:'+JSON.stringify(p.id)+',name:'+JSON.stringify(p.name)+',custom:'+(p.custom?'true':'false')+',subs:[\n'+sa.join(',\n')+'\n  ]}'+(i<structure.length-1?',':''));
  }
  lines.push(']');return lines.join('\n');
}
function generateTool(){
  if(!parsedStructure||!parsedFunds){showMsg('msgErr','No CSV loaded.');return;}
  try{
    var tmpl=atob(TOOL_TEMPLATE_B64);
    var html=tmpl.replace('%%FUNDS_JSON%%',JSON.stringify(parsedFunds)).replace('%%STRUCTURE_JS%%',structureToJS(parsedStructure));
    var blob=new Blob([html],{type:'text/html;charset=utf-8'});
    var url=URL.createObjectURL(blob);
    var a=document.createElement('a');a.href=url;a.download='portfolio_tool.html';
    document.body.appendChild(a);a.click();
    setTimeout(function(){URL.revokeObjectURL(url);document.body.removeChild(a);},1500);
    setStep(3);showMsg('msgDone','\u2705 portfolio_tool.html downloaded!');
  }catch(err){showMsg('msgErr','Generate failed: '+err.message);}
}
document.getElementById('fileInput').addEventListener('change',function(){if(this.files&&this.files[0])handleFile(this.files[0]);});
var dz=document.getElementById('dropZone');
dz.addEventListener('dragover',function(e){e.preventDefault();dz.classList.add('drag');});
dz.addEventListener('dragleave',function(){dz.classList.remove('drag');});
dz.addEventListener('drop',function(e){e.preventDefault();dz.classList.remove('drag');var f=e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0];if(f)handleFile(f);});
document.getElementById('btnPreview').addEventListener('click',function(){
  if(!parsedStructure)return;renderPreview(parsedStructure,parsedFunds);
  document.getElementById('btnGenerate').disabled=false;
  document.getElementById('previewCard').scrollIntoView({behavior:'smooth',block:'start'});
});
document.getElementById('btnGenerate').addEventListener('click',generateTool);
document.getElementById('btnAdminReset').addEventListener('click',function(){
  parsedStructure=null;parsedFunds=null;
  document.getElementById('fileInput').value='';document.getElementById('dzFname').textContent='';
  dz.classList.remove('loaded','drag');
  document.getElementById('btnPreview').disabled=true;document.getElementById('btnGenerate').disabled=true;
  document.getElementById('preview').style.display='none';document.getElementById('placeholder').style.display='';
  hideMsg('msgErr');hideMsg('msgDone');setStep(1);
});
document.getElementById('fab').addEventListener('click',function(){window.scrollTo({top:0,behavior:'smooth'});});

</script>
</body>
</html>